import{d as G,r as B,b as M,s as q,e as C,f as fe,w as ie,g as ye,h as V,i as me,u as ve,p as pe,t as ge,j as se,k as $,o as H,c as j,l as z,m as W,F as Q,n as ae,q as ne,v as we,x as xe,y as _e,z as be,_ as De}from"./app.ec347df2.js";let O;const Ue=new Uint8Array(16);function Me(){if(!O&&(O=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!O))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return O(Ue)}const y=[];for(let e=0;e<256;++e)y.push((e+256).toString(16).slice(1));function Be(e,n=0){return(y[e[n+0]]+y[e[n+1]]+y[e[n+2]]+y[e[n+3]]+"-"+y[e[n+4]]+y[e[n+5]]+"-"+y[e[n+6]]+y[e[n+7]]+"-"+y[e[n+8]]+y[e[n+9]]+"-"+y[e[n+10]]+y[e[n+11]]+y[e[n+12]]+y[e[n+13]]+y[e[n+14]]+y[e[n+15]]).toLowerCase()}const Ne=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),oe={randomUUID:Ne};function Ee(e,n,o){if(oe.randomUUID&&!n&&!e)return oe.randomUUID();e=e||{};const t=e.random||(e.rng||Me)();if(t[6]=t[6]&15|64,t[8]=t[8]&63|128,n){o=o||0;for(let s=0;s<16;++s)n[o+s]=t[s];return n}return Be(t)}var Se=Object.defineProperty,Ae=(e,n,o)=>n in e?Se(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,Re=(e,n,o)=>(Ae(e,typeof n!="symbol"?n+"":n,o),o);function $e(e){const n=B({transition:"inherit"});return ie(()=>e,o=>{const t=Object.entries($(o)).reduce((s,g)=>{const[c,u]=g;return typeof u=="number"?s[c]=`${u}px`:s[c]=u,s},{});n.value={...n.value,...t}},{deep:!0}),n}var P=class{static on(e,n){Array.isArray(P._callbacks[e])||(P._callbacks[e]=[]),P._callbacks[e].push(n)}static emit(e,...n){var o;(o=P._callbacks[e])==null||o.forEach(t=>t.apply(this,n))}static off(e){P._callbacks[e].length=0}},N=P;Re(N,"_callbacks",{});var ee=Symbol("Scene");function L(e,n,o=1/0){return Math.max(Math.min(e,o),n)}function ke(e,n,o){const t=Math.round(n/e[0])*e[0],s=Math.round(o/e[1])*e[1];return[t,s]}var F=20;function Le(e,n,o,t,s,g,c){const u=t?/t/.test(t):!1,i=t?/l/.test(t):!1,h=t?/b/.test(t):!1,m=t?/r/.test(t):!1,b=t?t.length===2:!1,{width:d,height:a,x:E,y:S}=o,k=J=>{const{clientX:I,clientY:A}=J;let D=I-e,U=A-n;Array.isArray(g)&&([D,U]=ke(g,D,U));const T=d/a,X=d+(i?-D:m?D:0),Y=a+(u?-U:h?U:0);b&&s?Math.abs(D)>=Math.abs(U)?(o.x=E+(i?D:0),o.width=L(X,F),o.height=L(X/T,F)):(o.y=S+(u?U:0),o.height=L(Y,F),o.width=L(Y*T,F)):(o.x=E+(i?D:0),o.y=S+(u?U:0),o.width=L(X,F),o.height=L(Y,F)),c&&c.onMove&&c.onMove()},l=()=>{document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",l),c&&c.onMove&&c.onUp()};document.addEventListener("mousemove",k),document.addEventListener("mouseup",l)}var Fe=["t","r","l","b","lt","lb","rt","rb"],Pe=G({name:"FreeDom",props:{x:{type:Number,default:0},y:{type:Number,default:0},width:{type:Number,default:0},height:{type:Number,default:0},absolute:{type:Boolean,default:void 0},scale:{type:[Boolean,Array],default:void 0},move:Boolean,preview:Boolean,limitWidth:{type:Number,default:void 0},limitHeight:{type:Number,default:void 0},handler:{type:String,default:void 0},diagonal:{type:Boolean,default:void 0},grid:{type:Object,default:void 0},onDragStart:{type:Function,default:void 0},onDragEnd:{type:Function,default:void 0}},emits:["update:x","update:y","update:width","update:height","select"],setup(e,{emit:n}){const o=B(!1),t=se(ee,void 0),s=M(()=>(t==null?void 0:t.preview)||e.preview),g=M(()=>!s.value&&((t==null?void 0:t.scale)||e.scale)),c=M(()=>!s.value&&((t==null?void 0:t.move)||e.move)),u=M(()=>e.absolute??(t==null?void 0:t.absolute)??!0),i=M(()=>e.handler??(t==null?void 0:t.handler)??"dot"),h=M(()=>e.grid??(t==null?void 0:t.grid)),m=M(()=>e.diagonal??(t==null?void 0:t.diagonal)??!0),b=q(),d=B({}),a=$e(d),E=Ee(),S=B(!1),k=B(!1),l=C({x:0,y:0,width:0,height:0}),J={_rect:l,trigger:A};fe(b,()=>{o.value=!1});function I(r){return typeof r=="number"?r:parseFloat(r)}ie([()=>e.width,()=>e.height,()=>e.x,()=>e.y],()=>{l.width=e.width,l.height=e.height,l.x=e.x,l.y=e.y,A()},{immediate:!0}),ye(async()=>{t==null||t.register(E,J);const r=b.value.getBoundingClientRect();l.width=l.width||r.width,l.height=l.height||r.height,l.x=l.x||0,l.y=l.y||0,A(),Z()});function A(){const{x:r,y:p,width:f,height:v}=l;d.value={transform:`translate(${r}px, ${p}px)`,width:f,height:v}}const D=M(()=>t&&Array.isArray(t.scale)?t.scale:e.scale),U=M(()=>X.value?Array.isArray(D.value)?D.value:Fe:[]),T={l:"w",r:"e",t:"n",b:"s"},X=q(!0);function Y(r,p){var _;if(r.stopPropagation(),r.preventDefault(),k.value||(S.value=!0,o.value=!0,((_=e.onDragStart)==null?void 0:_.call(e))===!1))return;const{clientX:v,clientY:x}=r;Le(v,x,l,p,m.value,h.value,{onMove(){te(l)&&(N.emit("move",E),A())},onUp(){var w;(w=e.onDragEnd)==null||w.call(e),S.value=!1,N.emit("moveup",E),Z()}})}function Z(){n("update:x",l.x),n("update:y",l.y),n("update:width",l.width),n("update:height",l.height)}function re(r){if(!d.value)return{};const{width:p,height:f}=d.value,v=/l/.test(r),x=/r/.test(r),_=/t/.test(r);let w,R;return r.length===2?(w=v?0:p,R=_?0:f):v||x?(w=v?0:p,R=Number(f)/2):(w=Number(p)/2,R=_?0:f),{top:i.value==="dot"?R:R-3+"px",left:i.value==="dot"?w:w-3+"px",cursor:r.split("").reverse().map(K=>T[K]).join("")+"-resize"}}function le(r){var _;if(r.stopPropagation(),S.value||!c.value||(k.value=!0,o.value=!0,((_=e.onDragStart)==null?void 0:_.call(e))===!1))return;const f=ue(d.value),v=w=>{const{clientX:R,clientY:K}=w,ce=R-r.clientX+f.x,he=K-r.clientY+f.y;l.x=ce,l.y=he,l.width=f.width,l.height=f.height,te(l)&&(N.emit("move",E),A())},x=()=>{var w;(w=e.onDragEnd)==null||w.call(e),k.value=!1,N.emit("moveup",E),document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",x),Z(),n("select",l)};document.addEventListener("mousemove",v),document.addEventListener("mouseup",x)}function te(r){if(t)return t.checkValid(r);if(e.limitWidth&&e.limitHeight){const{x:p,y:f,width:v,height:x}=r;return p>=0&&p+v<=e.limitWidth&&f>=0&&f+x<=e.limitHeight}else return!0}function ue(r){const{transform:p,width:f,height:v}=r,{x,y:_}=de(p);return{x:x?Number(x):0,y:_?Number(_):0,width:parseFloat(f),height:parseFloat(v)}}function de(r){if(!r)return{x:0,y:0};const p=/translate\(([.0-9]+)px[, ]+([.0-9]+)px\)/,[,f,v]=p.exec(r)??[];return{x:I(f),y:I(v)}}return{widgetRef:b,canMove:c,wrapStyle:a,canScale:g,dots:U,active:o,isAbsolute:u,isScale:S,handlerType:i,getDotPos:re,onMousedown:le,onMousedownDot:Y}},render(){const e=this.canScale?this.dots.map(o=>V("div",{class:this.handlerType==="dot"?"free-dom__widget-dot":"free-dom__resizable-handler",style:this.getDotPos(o),onMousedown:t=>this.onMousedownDot(t,o)})):null,n=typeof this.$slots.default=="function"?this.$slots.default():this.$slots.default;return V("section",{ref:"widgetRef",class:["free-dom__widget-wrapper",{"is-scale":this.isScale},{"is-absolute":this.isAbsolute},{"can-move":this.canMove},{"is-active":this.active}],style:this.wrapStyle,onMousedown:this.onMousedown},[n,e])}}),Ve=["xt","xc","xb","yl","yc","yr"],Xe=G({setup(){const e=se(ee),n=q(Ve),o=B(e.diff),t=e.nodes,s=C({xt:{show:!1,pos:0},xc:{show:!1,pos:0},xb:{show:!1,pos:0},yl:{show:!1,pos:0},yc:{show:!1,pos:0},yr:{show:!1,pos:0}});N.on("move",async i=>{var m;const h=((m=t.find(b=>b.uuid===i))==null?void 0:m.node)??{};g(),t.forEach(b=>{if(b.uuid===i)return;const d=c(h._rect),a=c(b.node._rect);u(d.top,a.top)&&(s.xt={show:!0,pos:a.top},h._rect.y=a.top),u(d.bottom,a.top)&&(s.xt={show:!0,pos:a.top},h._rect.y=a.top-d.height),u(d.centerY,a.centerY)&&(s.xc={show:!0,pos:a.centerY},h._rect.y=a.centerY-d.height/2),u(d.top,a.bottom)&&(s.xb={show:!0,pos:a.bottom},h._rect.y=a.bottom),u(d.bottom,a.bottom)&&(s.xb={show:!0,pos:a.bottom},h._rect.y=a.bottom-d.height),u(d.left,a.left)&&(s.yl={show:!0,pos:a.left},h._rect.x=a.left),u(d.right,a.left)&&(s.yl={show:!0,pos:a.left},h._rect.x=a.left-d.width),u(d.centerX,a.centerX)&&(s.yc={show:!0,pos:a.centerX},h._rect.x=a.centerX-d.width/2),u(d.left,a.right)&&(s.yr={show:!0,pos:a.right},h._rect.x=a.right),u(d.right,a.right)&&(s.yr={show:!0,pos:a.right},h._rect.x=a.right-d.width)})}),N.on("moveup",g),me(()=>{N.off("move"),N.off("moveup")});function g(){s.xt.show=!1,s.xc.show=!1,s.xb.show=!1,s.yl.show=!1,s.yc.show=!1,s.yr.show=!1}function c(i){return{top:i.y,bottom:i.y+i.height,left:i.x,right:i.x+i.width,width:i.width,height:i.height,centerX:i.x+i.width/2,centerY:i.y+i.height/2}}function u(i,h){return Math.abs(i-h)<=o.value}return{lines:n,diff:o,lineStatus:s}},render(){const e=(o,t)=>V("div",{style:{[o.includes("x")?"top":"left"]:t.pos+"px"},class:[o.includes("x")?"free-dom__xline":"free-dom__yline","free-dom__line"]}),n=this.lines.filter(o=>this.lineStatus[o].show).map(o=>e(o,this.lineStatus[o]));return V("div",{class:"free-dom__mark-line"},n)}}),Ye={absolute:{type:Boolean,default:void 0},preview:Boolean,move:Boolean,scale:[Boolean,Array],diff:{type:Number,default:3},handler:{type:String,default:void 0},diagonal:{type:Boolean,default:void 0},grid:{type:Object,default:void 0}},ze=G({name:"FreeDomWrap",props:Ye,setup(e){const n=q(null),o=ve(n),t=B([]);function s(c,u){t.value.push({uuid:c,node:u})}function g(c){const{x:u,y:i,width:h,height:m}=c;return u>=0&&u+h<=o.width.value&&i>=0&&i+m<=o.height.value}return pe(ee,C({...ge(e),nodes:t,register:s,checkValid:g})),{rectRef:n}},render(){const e=typeof this.$slots.default=="function"?this.$slots.default():this.$slots.default;return V("section",{ref:"rectRef"},[e,V(Xe)])}}),He=Pe,Ie=ze;const Te=G({__name:"Home",setup(e){const n=B(!1),o=B([{text:"测试文本",x:50,style:{color:"#d1239d"}},{text:"测试文本",style:{fontSize:"24px"}}]);function t(){n.value=!n.value}function s(){o.value.push({text:"测试文本",style:{}})}function g(c){console.log(c)}return(c,u)=>(H(),j(Q,null,[z("button",{onClick:s}," 添加 "),z("button",{style:{"margin-left":"20px"},onClick:t},W($(n)?"显示":"隐藏"),1),$(n)?be("",!0):(H(),j(Q,{key:0},[ae($(Ie),{move:"",scale:"",style:{width:"600px",height:"400px",border:"1px solid #999",position:"relative"}},{default:ne(()=>[(H(!0),j(Q,null,we($(o),(i,h)=>(H(),xe($(He),{key:h,x:i.x,"onUpdate:x":m=>i.x=m,y:i.y,"onUpdate:y":m=>i.y=m,width:i.width,"onUpdate:width":m=>i.width=m,height:i.height,"onUpdate:height":m=>i.height=m,scale:["rb"],style:_e(i.style),handler:"mark",onSelect:g},{default:ne(()=>[z("div",null,[z("span",null,W(i.text)+W(h),1)])]),_:2},1032,["x","onUpdate:x","y","onUpdate:y","width","onUpdate:width","height","onUpdate:height","style"]))),128))]),_:1}),z("pre",null,W($(o)),1)],64))],64))}}),qe=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"index.md"}'),We={name:"index.md"};function Oe(e,n,o,t,s,g){const c=Te;return H(),j("div",null,[ae(c)])}const Ge=De(We,[["render",Oe]]);export{qe as __pageData,Ge as default};
