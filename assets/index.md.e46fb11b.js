import{d as q,r as M,b,s as j,e as C,u as he,f as fe,w as pe,g as me,n as ye,h as F,i as ve,j as ge,k as we,p as xe,t as _e,l as be,m as se,q as k,o as z,c as O,v as Y,x as I,F as Q,y as ie,z as oe,A as Me,B as Ue,C as Be,D as De,_ as Ne}from"./app.b038ec54.js";let W;const Ae=new Uint8Array(16);function Ee(){if(!W&&(W=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!W))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return W(Ae)}const m=[];for(let e=0;e<256;++e)m.push((e+256).toString(16).slice(1));function Se(e,o=0){return(m[e[o+0]]+m[e[o+1]]+m[e[o+2]]+m[e[o+3]]+"-"+m[e[o+4]]+m[e[o+5]]+"-"+m[e[o+6]]+m[e[o+7]]+"-"+m[e[o+8]]+m[e[o+9]]+"-"+m[e[o+10]]+m[e[o+11]]+m[e[o+12]]+m[e[o+13]]+m[e[o+14]]+m[e[o+15]]).toLowerCase()}const ke=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ne={randomUUID:ke};function Re(e,o,n){if(ne.randomUUID&&!o&&!e)return ne.randomUUID();e=e||{};const t=e.random||(e.rng||Ee)();if(t[6]=t[6]&15|64,t[8]=t[8]&63|128,o){n=n||0;for(let s=0;s<16;++s)o[n+s]=t[s];return o}return Se(t)}var $e=Object.defineProperty,Le=(e,o,n)=>o in e?$e(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,Pe=(e,o,n)=>(Le(e,typeof o!="symbol"?o+"":o,n),n);function Fe(e){const o=M({transition:"inherit"});return be(()=>e,n=>{const t=Object.entries(k(n)).reduce((s,y)=>{const[d,u]=y;return typeof u=="number"?s[d]=`${u}px`:s[d]=u,s},{});o.value={...o.value,...t}},{deep:!0}),o}var P=class{static on(e,o){Array.isArray(P._callbacks[e])||(P._callbacks[e]=[]),P._callbacks[e].push(o)}static emit(e,...o){var n;(n=P._callbacks[e])==null||n.forEach(t=>t.apply(this,o))}static off(e){P._callbacks[e].length=0}},U=P;Pe(U,"_callbacks",{});var ee=Symbol("Scene");function $(e,o,n=1/0){return Math.max(Math.min(e,n),o)}function Te(e,o,n){const t=Math.round(o/e[0])*e[0],s=Math.round(n/e[1])*e[1];return[t,s]}var L=20;function Ve(e,o,n,t,s,y,d){const u=t?/t/.test(t):!1,i=t?/l/.test(t):!1,h=t?/b/.test(t):!1,v=t?/r/.test(t):!1,x=t?t.length===2:!1,{width:c,height:r,x:B,y:N}=n,R=G=>{const{clientX:J,clientY:H}=G;let _=J-e,w=H-o;Array.isArray(y)&&([_,w]=Te(y,_,w));const T=c/r,V=c+(i?-_:v?_:0),X=r+(u?-w:h?w:0);x&&s?Math.abs(_)>=Math.abs(w)?(n.x=B+(i?_:0),n.width=$(V,L),n.height=$(V/T,L)):(n.y=N+(u?w:0),n.height=$(X,L),n.width=$(X*T,L)):(n.x=B+(i?_:0),n.y=N+(u?w:0),n.width=$(V,L),n.height=$(X,L)),d&&d.onMove&&d.onMove()},l=()=>{document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",l),d&&d.onMove&&d.onUp()};document.addEventListener("mousemove",R),document.addEventListener("mouseup",l)}var Xe=["t","r","l","b","lt","lb","rt","rb"],Ye=q({name:"FreeDom",props:{x:{type:Number,default:0},y:{type:Number,default:0},width:{type:Number,default:0},height:{type:Number,default:0},absolute:{type:Boolean,default:void 0},scale:{type:[Boolean,Array],default:void 0},move:Boolean,preview:Boolean,limitWidth:{type:Number,default:void 0},limitHeight:{type:Number,default:void 0},handler:{type:String,default:void 0},diagonal:{type:Boolean,default:void 0},grid:{type:Object,default:void 0}},emits:["update:x","update:y","update:width","update:height","select"],setup(e,{emit:o}){const n=M(!1),t=se(ee),s=b(()=>(t==null?void 0:t.preview)||e.preview),y=b(()=>!s.value&&((t==null?void 0:t.scale)||e.scale)),d=b(()=>!s.value&&((t==null?void 0:t.move)||e.move)),u=b(()=>e.absolute??(t==null?void 0:t.absolute)??!0),i=b(()=>e.handler??(t==null?void 0:t.handler)??"dot"),h=b(()=>e.grid??(t==null?void 0:t.grid)),v=b(()=>e.diagonal??(t==null?void 0:t.diagonal)??!0),x=j(),c=M({}),r=Fe(c),B=Re(),N=M(!1),R=M(!1),l=C({x:0,y:0,width:0,height:0}),G=he(w),J={_rect:l,trigger:w};fe(x,()=>{n.value=!1});function H(a){return typeof a=="number"?a:parseFloat(a)}let _=!1;pe(()=>{l.width=e.width,l.height=e.height,l.x=e.x,l.y=e.y,_&&G(),_=!0}),me(async()=>{t==null||t.register(B,J),await ye();const a=x.value.getBoundingClientRect();l.width=l.width||a.width,l.height=l.height||a.height,l.x=l.x||0,l.y=l.y||0,w(),Z()});function w(){const{x:a,y:f,width:p,height:g}=l;c.value={transform:`translate(${a}px, ${f}px)`,width:p,height:g}}const T=b(()=>t&&Array.isArray(t.scale)?t.scale:e.scale),V=b(()=>re.value?Array.isArray(T.value)?T.value:Xe:[]),X={l:"w",r:"e",t:"n",b:"s"},re=j(!0);function ae(a,f){if(a.stopPropagation(),a.preventDefault(),R.value)return;N.value=!0,n.value=!0;const{clientX:p,clientY:g}=a;Ve(p,g,l,f,v.value,h.value,{onMove(){te(l)&&(U.emit("move",B),w())},onUp(){N.value=!1,U.emit("moveup",B),Z()}})}function Z(){o("update:x",l.x),o("update:y",l.y),o("update:width",l.width),o("update:height",l.height)}function le(a){if(!c.value)return{};const{width:f,height:p}=c.value,g=/l/.test(a),D=/r/.test(a),A=/t/.test(a);let E,S;return a.length===2?(E=g?0:f,S=A?0:p):g||D?(E=g?0:f,S=Number(p)/2):(E=Number(f)/2,S=A?0:p),{top:i.value==="dot"?S:S-3+"px",left:i.value==="dot"?E:E-3+"px",cursor:a.split("").reverse().map(K=>X[K]).join("")+"-resize"}}function ue(a){if(a.stopPropagation(),N.value||!d.value)return;R.value=!0,n.value=!0;const f=ce(c.value),p=D=>{const{clientX:A,clientY:E}=D,S=A-a.clientX+f.x,K=E-a.clientY+f.y;l.x=S,l.y=K,l.width=f.width,l.height=f.height,te(l)&&(U.emit("move",B),w())},g=()=>{R.value=!1,U.emit("moveup",B),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",g),Z(),o("select",l)};document.addEventListener("mousemove",p),document.addEventListener("mouseup",g)}function te(a){if(t)return t.checkValid(a);if(e.limitWidth&&e.limitHeight){const{x:f,y:p,width:g,height:D}=a;return f>=0&&f+g<=e.limitWidth&&p>=0&&p+D<=e.limitHeight}else return!0}function ce(a){const{transform:f,width:p,height:g}=a,{x:D,y:A}=de(f);return{x:D?Number(D):0,y:A?Number(A):0,width:parseFloat(p),height:parseFloat(g)}}function de(a){if(!a)return{x:0,y:0};const f=/translate\(([.0-9]+)px[, ]+([.0-9]+)px\)/,[,p,g]=f.exec(a)??[];return{x:H(p),y:H(g)}}return{widgetRef:x,canMove:d,wrapStyle:r,canScale:y,dots:V,active:n,isAbsolute:u,isScale:N,handlerType:i,getDotPos:le,onMousedown:ue,onMousedownDot:ae}},render(){const e=this.canScale?this.dots.map(s=>F("div",{class:this.handlerType==="dot"?"free-dom__widget-dot":"free-dom__resizable-handler",style:this.getDotPos(s),onMousedown:y=>this.onMousedownDot(y,s)})):null,o=typeof this.$slots.default=="function"?this.$slots.default():this.$slots.default;if(!o)return console.error("[free-dom] must have a default slot"),null;if(o.length>1)return console.error("[free-dom] must have only one default slot"),null;const n=o[0],t=ve(n);return Array.isArray(t.children)?t.children=[...t.children,...e]:console.error("[free-dom] generate resiable handles failed"),F(t,{ref:"widgetRef",class:["free-dom__widget-wrapper",{"is-scale":this.isScale},{"is-absolute":this.isAbsolute},{"can-move":this.canMove},{"is-active":this.active}],style:this.wrapStyle,onMousedown:this.onMousedown})}}),ze=["xt","xc","xb","yl","yc","yr"],He=q({setup(){const e=se(ee),o=j(ze),n=M(e.diff),t=e.nodes,s=C({xt:{show:!1,pos:0},xc:{show:!1,pos:0},xb:{show:!1,pos:0},yl:{show:!1,pos:0},yc:{show:!1,pos:0},yr:{show:!1,pos:0}});U.on("move",async i=>{var v;const h=((v=t.find(x=>x.uuid===i))==null?void 0:v.node)??{};y(),t.forEach(x=>{if(x.uuid===i)return;const c=d(h._rect),r=d(x.node._rect);u(c.top,r.top)&&(s.xt={show:!0,pos:r.top},h._rect.y=r.top),u(c.bottom,r.top)&&(s.xt={show:!0,pos:r.top},h._rect.y=r.top-c.height),u(c.centerY,r.centerY)&&(s.xc={show:!0,pos:r.centerY},h._rect.y=r.centerY-c.height/2),u(c.top,r.bottom)&&(s.xb={show:!0,pos:r.bottom},h._rect.y=r.bottom),u(c.bottom,r.bottom)&&(s.xb={show:!0,pos:r.bottom},h._rect.y=r.bottom-c.height),u(c.left,r.left)&&(s.yl={show:!0,pos:r.left},h._rect.x=r.left),u(c.right,r.left)&&(s.yl={show:!0,pos:r.left},h._rect.x=r.left-c.width),u(c.centerX,r.centerX)&&(s.yc={show:!0,pos:r.centerX},h._rect.x=r.centerX-c.width/2),u(c.left,r.right)&&(s.yr={show:!0,pos:r.right},h._rect.x=r.right),u(c.right,r.right)&&(s.yr={show:!0,pos:r.right},h._rect.x=r.right-c.width)})}),U.on("moveup",y),ge(()=>{U.off("move"),U.off("moveup")});function y(){s.xt.show=!1,s.xc.show=!1,s.xb.show=!1,s.yl.show=!1,s.yc.show=!1,s.yr.show=!1}function d(i){return{top:i.y,bottom:i.y+i.height,left:i.x,right:i.x+i.width,width:i.width,height:i.height,centerX:i.x+i.width/2,centerY:i.y+i.height/2}}function u(i,h){return Math.abs(i-h)<=n.value}return{lines:o,diff:n,lineStatus:s}},render(){const e=(n,t)=>F("div",{style:{[n.includes("x")?"top":"left"]:t.pos+"px"},class:[n.includes("x")?"free-dom__xline":"free-dom__yline","free-dom__line"]}),o=this.lines.filter(n=>this.lineStatus[n].show).map(n=>e(n,this.lineStatus[n]));return F("div",{class:"free-dom__mark-line"},o)}}),Ie={absolute:{type:Boolean,default:void 0},preview:Boolean,move:Boolean,scale:[Boolean,Array],diff:{type:Number,default:3},handler:{type:String,default:void 0},diagonal:{type:Boolean,default:void 0},grid:{type:Object,default:void 0}},We=q({name:"FreeDomWrap",props:Ie,setup(e){const o=j(null),n=we(o),t=M([]);function s(d,u){t.value.push({uuid:d,node:u})}function y(d){const{x:u,y:i,width:h,height:v}=d;return u>=0&&u+h<=n.width.value&&i>=0&&i+v<=n.height.value}return xe(ee,C({..._e(e),nodes:t,register:s,checkValid:y})),{rectRef:o}},render(){const e=typeof this.$slots.default=="function"?this.$slots.default():this.$slots.default;return F("section",{ref:"rectRef"},[e,F(He)])}}),Oe=Ye,je=We;const qe=q({__name:"Home",setup(e){const o=M(!1),n=M([{text:"测试文本",x:50,style:{color:"#d1239d"}},{text:"测试文本",style:{fontSize:"24px"}}]);function t(){o.value=!o.value}function s(){n.value.push({text:"测试文本",style:{}})}function y(d){console.log(d)}return(d,u)=>(z(),O(Q,null,[Y("button",{onClick:s}," 添加 "),Y("button",{style:{"margin-left":"20px"},onClick:t},I(k(o)?"显示":"隐藏"),1),k(o)?De("",!0):(z(),O(Q,{key:0},[ie(k(je),{move:"",scale:"",style:{width:"600px",height:"400px",border:"1px solid #999",position:"relative"}},{default:oe(()=>[(z(!0),O(Q,null,Me(k(n),(i,h)=>(z(),Ue(k(Oe),{key:h,x:i.x,"onUpdate:x":v=>i.x=v,y:i.y,"onUpdate:y":v=>i.y=v,width:i.width,"onUpdate:width":v=>i.width=v,height:i.height,"onUpdate:height":v=>i.height=v,scale:["rb"],style:Be(i.style),handler:"mark",onSelect:y},{default:oe(()=>[Y("div",null,[Y("span",null,I(i.text)+I(h),1)])]),_:2},1032,["x","onUpdate:x","y","onUpdate:y","width","onUpdate:width","height","onUpdate:height","style"]))),128))]),_:1}),Y("pre",null,I(k(n)),1)],64))],64))}}),Ke=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"index.md"}'),Ge={name:"index.md"};function Je(e,o,n,t,s,y){const d=qe;return z(),O("div",null,[ie(d)])}const Qe=Ne(Ge,[["render",Je]]);export{Ke as __pageData,Qe as default};
