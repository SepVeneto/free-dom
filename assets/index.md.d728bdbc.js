import{d as q,r as B,b as M,s as j,e as C,u as ye,f as me,w as ve,g as pe,n as ge,h as P,i as we,j as xe,p as _e,t as be,k as De,l as se,m as k,o as z,c as O,q as Y,v as I,F as Q,x as ie,y as ne,z as Ue,A as Me,B as Be,C as Ee,_ as Ne}from"./app.8638193c.js";let W;const Se=new Uint8Array(16);function Ae(){if(!W&&(W=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!W))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return W(Se)}const y=[];for(let e=0;e<256;++e)y.push((e+256).toString(16).slice(1));function ke(e,n=0){return(y[e[n+0]]+y[e[n+1]]+y[e[n+2]]+y[e[n+3]]+"-"+y[e[n+4]]+y[e[n+5]]+"-"+y[e[n+6]]+y[e[n+7]]+"-"+y[e[n+8]]+y[e[n+9]]+"-"+y[e[n+10]]+y[e[n+11]]+y[e[n+12]]+y[e[n+13]]+y[e[n+14]]+y[e[n+15]]).toLowerCase()}const Re=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),oe={randomUUID:Re};function $e(e,n,o){if(oe.randomUUID&&!n&&!e)return oe.randomUUID();e=e||{};const t=e.random||(e.rng||Ae)();if(t[6]=t[6]&15|64,t[8]=t[8]&63|128,n){o=o||0;for(let i=0;i<16;++i)n[o+i]=t[i];return n}return ke(t)}var Le=Object.defineProperty,Fe=(e,n,o)=>n in e?Le(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,Pe=(e,n,o)=>(Fe(e,typeof n!="symbol"?n+"":n,o),o);function Te(e){const n=B({transition:"inherit"});return De(()=>e,o=>{const t=Object.entries(k(o)).reduce((i,g)=>{const[d,u]=g;return typeof u=="number"?i[d]=`${u}px`:i[d]=u,i},{});n.value={...n.value,...t}},{deep:!0}),n}var F=class{static on(e,n){Array.isArray(F._callbacks[e])||(F._callbacks[e]=[]),F._callbacks[e].push(n)}static emit(e,...n){var o;(o=F._callbacks[e])==null||o.forEach(t=>t.apply(this,n))}static off(e){F._callbacks[e].length=0}},E=F;Pe(E,"_callbacks",{});var ee=Symbol("Scene");function $(e,n,o=1/0){return Math.max(Math.min(e,o),n)}function Ve(e,n,o){const t=Math.round(n/e[0])*e[0],i=Math.round(o/e[1])*e[1];return[t,i]}var L=20;function Xe(e,n,o,t,i,g,d){const u=t?/t/.test(t):!1,s=t?/l/.test(t):!1,h=t?/b/.test(t):!1,m=t?/r/.test(t):!1,D=t?t.length===2:!1,{width:c,height:a,x:N,y:S}=o,R=G=>{const{clientX:J,clientY:H}=G;let U=J-e,w=H-n;Array.isArray(g)&&([U,w]=Ve(g,U,w));const T=c/a,V=c+(s?-U:m?U:0),X=a+(u?-w:h?w:0);D&&i?Math.abs(U)>=Math.abs(w)?(o.x=N+(s?U:0),o.width=$(V,L),o.height=$(V/T,L)):(o.y=S+(u?w:0),o.height=$(X,L),o.width=$(X*T,L)):(o.x=N+(s?U:0),o.y=S+(u?w:0),o.width=$(V,L),o.height=$(X,L)),d&&d.onMove&&d.onMove()},l=()=>{document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",l),d&&d.onMove&&d.onUp()};document.addEventListener("mousemove",R),document.addEventListener("mouseup",l)}var Ye=["t","r","l","b","lt","lb","rt","rb"],ze=q({name:"FreeDom",props:{x:{type:Number,default:0},y:{type:Number,default:0},width:{type:Number,default:0},height:{type:Number,default:0},absolute:{type:Boolean,default:void 0},scale:{type:[Boolean,Array],default:void 0},move:Boolean,preview:Boolean,limitWidth:{type:Number,default:void 0},limitHeight:{type:Number,default:void 0},handler:{type:String,default:void 0},diagonal:{type:Boolean,default:void 0},grid:{type:Object,default:void 0},onDragStart:{type:Function,default:void 0},onDragEnd:{type:Function,default:void 0}},emits:["update:x","update:y","update:width","update:height","select"],setup(e,{emit:n}){const o=B(!1),t=se(ee),i=M(()=>(t==null?void 0:t.preview)||e.preview),g=M(()=>!i.value&&((t==null?void 0:t.scale)||e.scale)),d=M(()=>!i.value&&((t==null?void 0:t.move)||e.move)),u=M(()=>e.absolute??(t==null?void 0:t.absolute)??!0),s=M(()=>e.handler??(t==null?void 0:t.handler)??"dot"),h=M(()=>e.grid??(t==null?void 0:t.grid)),m=M(()=>e.diagonal??(t==null?void 0:t.diagonal)??!0),D=j(),c=B({}),a=Te(c),N=$e(),S=B(!1),R=B(!1),l=C({x:0,y:0,width:0,height:0}),G=ye(w),J={_rect:l,trigger:w};me(D,()=>{o.value=!1});function H(r){return typeof r=="number"?r:parseFloat(r)}let U=!1;ve(()=>{l.width=e.width,l.height=e.height,l.x=e.x,l.y=e.y,U&&G(),U=!0}),pe(async()=>{t==null||t.register(N,J),await ge();const r=D.value.getBoundingClientRect();l.width=l.width||r.width,l.height=l.height||r.height,l.x=l.x||0,l.y=l.y||0,w(),Z()});function w(){const{x:r,y:p,width:f,height:v}=l;c.value={transform:`translate(${r}px, ${p}px)`,width:f,height:v}}const T=M(()=>t&&Array.isArray(t.scale)?t.scale:e.scale),V=M(()=>ae.value?Array.isArray(T.value)?T.value:Ye:[]),X={l:"w",r:"e",t:"n",b:"s"},ae=j(!0);function re(r,p){var b;if(r.stopPropagation(),r.preventDefault(),R.value||(S.value=!0,o.value=!0,((b=e.onDragStart)==null?void 0:b.call(e))===!1))return;const{clientX:v,clientY:_}=r;Xe(v,_,l,p,m.value,h.value,{onMove(){te(l)&&(E.emit("move",N),w())},onUp(){var x;(x=e.onDragEnd)==null||x.call(e),S.value=!1,E.emit("moveup",N),Z()}})}function Z(){n("update:x",l.x),n("update:y",l.y),n("update:width",l.width),n("update:height",l.height)}function le(r){if(!c.value)return{};const{width:p,height:f}=c.value,v=/l/.test(r),_=/r/.test(r),b=/t/.test(r);let x,A;return r.length===2?(x=v?0:p,A=b?0:f):v||_?(x=v?0:p,A=Number(f)/2):(x=Number(p)/2,A=b?0:f),{top:s.value==="dot"?A:A-3+"px",left:s.value==="dot"?x:x-3+"px",cursor:r.split("").reverse().map(K=>X[K]).join("")+"-resize"}}function ue(r){var b;if(r.stopPropagation(),S.value||!d.value||(R.value=!0,o.value=!0,((b=e.onDragStart)==null?void 0:b.call(e))===!1))return;const f=ce(c.value),v=x=>{const{clientX:A,clientY:K}=x,he=A-r.clientX+f.x,fe=K-r.clientY+f.y;l.x=he,l.y=fe,l.width=f.width,l.height=f.height,te(l)&&(E.emit("move",N),w())},_=()=>{var x;(x=e.onDragEnd)==null||x.call(e),R.value=!1,E.emit("moveup",N),document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",_),Z(),n("select",l)};document.addEventListener("mousemove",v),document.addEventListener("mouseup",_)}function te(r){if(t)return t.checkValid(r);if(e.limitWidth&&e.limitHeight){const{x:p,y:f,width:v,height:_}=r;return p>=0&&p+v<=e.limitWidth&&f>=0&&f+_<=e.limitHeight}else return!0}function ce(r){const{transform:p,width:f,height:v}=r,{x:_,y:b}=de(p);return{x:_?Number(_):0,y:b?Number(b):0,width:parseFloat(f),height:parseFloat(v)}}function de(r){if(!r)return{x:0,y:0};const p=/translate\(([.0-9]+)px[, ]+([.0-9]+)px\)/,[,f,v]=p.exec(r)??[];return{x:H(f),y:H(v)}}return{widgetRef:D,canMove:d,wrapStyle:a,canScale:g,dots:V,active:o,isAbsolute:u,isScale:S,handlerType:s,getDotPos:le,onMousedown:ue,onMousedownDot:re}},render(){const e=this.canScale?this.dots.map(o=>P("div",{class:this.handlerType==="dot"?"free-dom__widget-dot":"free-dom__resizable-handler",style:this.getDotPos(o),onMousedown:t=>this.onMousedownDot(t,o)})):null,n=typeof this.$slots.default=="function"?this.$slots.default():this.$slots.default;return P("section",{ref:"widgetRef",class:["free-dom__widget-wrapper",{"is-scale":this.isScale},{"is-absolute":this.isAbsolute},{"can-move":this.canMove},{"is-active":this.active}],style:this.wrapStyle,onMousedown:this.onMousedown},[n,e])}}),He=["xt","xc","xb","yl","yc","yr"],Ie=q({setup(){const e=se(ee),n=j(He),o=B(e.diff),t=e.nodes,i=C({xt:{show:!1,pos:0},xc:{show:!1,pos:0},xb:{show:!1,pos:0},yl:{show:!1,pos:0},yc:{show:!1,pos:0},yr:{show:!1,pos:0}});E.on("move",async s=>{var m;const h=((m=t.find(D=>D.uuid===s))==null?void 0:m.node)??{};g(),t.forEach(D=>{if(D.uuid===s)return;const c=d(h._rect),a=d(D.node._rect);u(c.top,a.top)&&(i.xt={show:!0,pos:a.top},h._rect.y=a.top),u(c.bottom,a.top)&&(i.xt={show:!0,pos:a.top},h._rect.y=a.top-c.height),u(c.centerY,a.centerY)&&(i.xc={show:!0,pos:a.centerY},h._rect.y=a.centerY-c.height/2),u(c.top,a.bottom)&&(i.xb={show:!0,pos:a.bottom},h._rect.y=a.bottom),u(c.bottom,a.bottom)&&(i.xb={show:!0,pos:a.bottom},h._rect.y=a.bottom-c.height),u(c.left,a.left)&&(i.yl={show:!0,pos:a.left},h._rect.x=a.left),u(c.right,a.left)&&(i.yl={show:!0,pos:a.left},h._rect.x=a.left-c.width),u(c.centerX,a.centerX)&&(i.yc={show:!0,pos:a.centerX},h._rect.x=a.centerX-c.width/2),u(c.left,a.right)&&(i.yr={show:!0,pos:a.right},h._rect.x=a.right),u(c.right,a.right)&&(i.yr={show:!0,pos:a.right},h._rect.x=a.right-c.width)})}),E.on("moveup",g),we(()=>{E.off("move"),E.off("moveup")});function g(){i.xt.show=!1,i.xc.show=!1,i.xb.show=!1,i.yl.show=!1,i.yc.show=!1,i.yr.show=!1}function d(s){return{top:s.y,bottom:s.y+s.height,left:s.x,right:s.x+s.width,width:s.width,height:s.height,centerX:s.x+s.width/2,centerY:s.y+s.height/2}}function u(s,h){return Math.abs(s-h)<=o.value}return{lines:n,diff:o,lineStatus:i}},render(){const e=(o,t)=>P("div",{style:{[o.includes("x")?"top":"left"]:t.pos+"px"},class:[o.includes("x")?"free-dom__xline":"free-dom__yline","free-dom__line"]}),n=this.lines.filter(o=>this.lineStatus[o].show).map(o=>e(o,this.lineStatus[o]));return P("div",{class:"free-dom__mark-line"},n)}}),We={absolute:{type:Boolean,default:void 0},preview:Boolean,move:Boolean,scale:[Boolean,Array],diff:{type:Number,default:3},handler:{type:String,default:void 0},diagonal:{type:Boolean,default:void 0},grid:{type:Object,default:void 0}},Oe=q({name:"FreeDomWrap",props:We,setup(e){const n=j(null),o=xe(n),t=B([]);function i(d,u){t.value.push({uuid:d,node:u})}function g(d){const{x:u,y:s,width:h,height:m}=d;return u>=0&&u+h<=o.width.value&&s>=0&&s+m<=o.height.value}return _e(ee,C({...be(e),nodes:t,register:i,checkValid:g})),{rectRef:n}},render(){const e=typeof this.$slots.default=="function"?this.$slots.default():this.$slots.default;return P("section",{ref:"rectRef"},[e,P(Ie)])}}),je=ze,qe=Oe;const Ge=q({__name:"Home",setup(e){const n=B(!1),o=B([{text:"测试文本",x:50,style:{color:"#d1239d"}},{text:"测试文本",style:{fontSize:"24px"}}]);function t(){n.value=!n.value}function i(){o.value.push({text:"测试文本",style:{}})}function g(d){console.log(d)}return(d,u)=>(z(),O(Q,null,[Y("button",{onClick:i}," 添加 "),Y("button",{style:{"margin-left":"20px"},onClick:t},I(k(n)?"显示":"隐藏"),1),k(n)?Ee("",!0):(z(),O(Q,{key:0},[ie(k(qe),{move:"",scale:"",style:{width:"600px",height:"400px",border:"1px solid #999",position:"relative"}},{default:ne(()=>[(z(!0),O(Q,null,Ue(k(o),(s,h)=>(z(),Me(k(je),{key:h,x:s.x,"onUpdate:x":m=>s.x=m,y:s.y,"onUpdate:y":m=>s.y=m,width:s.width,"onUpdate:width":m=>s.width=m,height:s.height,"onUpdate:height":m=>s.height=m,scale:["rb"],style:Be(s.style),handler:"mark",onSelect:g},{default:ne(()=>[Y("div",null,[Y("span",null,I(s.text)+I(h),1)])]),_:2},1032,["x","onUpdate:x","y","onUpdate:y","width","onUpdate:width","height","onUpdate:height","style"]))),128))]),_:1}),Y("pre",null,I(k(o)),1)],64))],64))}}),Qe=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"index.md"}'),Je={name:"index.md"};function Ze(e,n,o,t,i,g){const d=Ge;return z(),O("div",null,[ie(d)])}const Ce=Ne(Je,[["render",Ze]]);export{Qe as __pageData,Ce as default};
