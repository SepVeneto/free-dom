import{d as q,r as E,b as M,s as j,e as ee,u as we,f as xe,w as _e,g as ae,h as C,i as be,n as De,j as V,k as Ue,p as Be,t as Me,l as re,m as R,o as H,c as O,q as Y,v as z,F as Q,x as le,y as ie,z as Ee,A as Ne,B as Se,C as Ae,_ as ke}from"./app.403e0c79.js";let I;const Re=new Uint8Array(16);function $e(){if(!I&&(I=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!I))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return I(Re)}const y=[];for(let e=0;e<256;++e)y.push((e+256).toString(16).slice(1));function Le(e,n=0){return(y[e[n+0]]+y[e[n+1]]+y[e[n+2]]+y[e[n+3]]+"-"+y[e[n+4]]+y[e[n+5]]+"-"+y[e[n+6]]+y[e[n+7]]+"-"+y[e[n+8]]+y[e[n+9]]+"-"+y[e[n+10]]+y[e[n+11]]+y[e[n+12]]+y[e[n+13]]+y[e[n+14]]+y[e[n+15]]).toLowerCase()}const Fe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),se={randomUUID:Fe};function Pe(e,n,o){if(se.randomUUID&&!n&&!e)return se.randomUUID();e=e||{};const t=e.random||(e.rng||$e)();if(t[6]=t[6]&15|64,t[8]=t[8]&63|128,n){o=o||0;for(let s=0;s<16;++s)n[o+s]=t[s];return n}return Le(t)}var Te=Object.defineProperty,Ve=(e,n,o)=>n in e?Te(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,Xe=(e,n,o)=>(Ve(e,typeof n!="symbol"?n+"":n,o),o);function Ye(e){const n=E({transition:"inherit"});return C(()=>e,o=>{const t=Object.entries(R(o)).reduce((s,p)=>{const[d,u]=p;return typeof u=="number"?s[d]=`${u}px`:s[d]=u,s},{});n.value={...n.value,...t}},{deep:!0}),n}var T=class{static on(e,n){Array.isArray(T._callbacks[e])||(T._callbacks[e]=[]),T._callbacks[e].push(n)}static emit(e,...n){var o;(o=T._callbacks[e])==null||o.forEach(t=>t.apply(this,n))}static off(e){T._callbacks[e].length=0}},N=T;Xe(N,"_callbacks",{});var te=Symbol("Scene");function F(e,n,o=1/0){return Math.max(Math.min(e,o),n)}function He(e,n,o){const t=Math.round(n/e[0])*e[0],s=Math.round(o/e[1])*e[1];return[t,s]}var P=20;function We(e,n,o,t,s,p,d){const u=t?/t/.test(t):!1,i=t?/l/.test(t):!1,h=t?/b/.test(t):!1,m=t?/r/.test(t):!1,x=t?t.length===2:!1,{width:c,height:r,x:S,y:A}=o,$=G=>{const{clientX:J,clientY:W}=G;let D=J-e,U=W-n;Array.isArray(p)&&([D,U]=He(p,D,U));const X=c/r,L=c+(i?-D:m?D:0),B=r+(u?-U:h?U:0);x&&s?Math.abs(D)>=Math.abs(U)?(o.x=S+(i?D:0),o.width=F(L,P),o.height=F(L/X,P)):(o.y=A+(u?U:0),o.height=F(B,P),o.width=F(B*X,P)):(o.x=S+(i?D:0),o.y=A+(u?U:0),o.width=F(L,P),o.height=F(B,P)),d&&d.onMove&&d.onMove()},l=()=>{document.removeEventListener("mousemove",$),document.removeEventListener("mouseup",l),d&&d.onMove&&d.onUp()};document.addEventListener("mousemove",$),document.addEventListener("mouseup",l)}var ze=["t","r","l","b","lt","lb","rt","rb"],Ie=q({name:"FreeDom",props:{x:{type:Number,default:void 0},y:{type:Number,default:void 0},width:{type:Number,default:void 0},height:{type:Number,default:void 0},absolute:{type:Boolean,default:void 0},scale:{type:[Boolean,Array],default:void 0},move:Boolean,preview:Boolean,limitWidth:{type:Number,default:void 0},limitHeight:{type:Number,default:void 0},handler:{type:String,default:void 0},diagonal:{type:Boolean,default:void 0},grid:{type:Object,default:void 0},onDragStart:{type:Function,default:void 0},onDragEnd:{type:Function,default:void 0}},emits:["update:x","update:y","update:width","update:height","select"],setup(e,{emit:n}){const o=E(!1),t=re(te),s=M(()=>(t==null?void 0:t.preview)||e.preview),p=M(()=>!s.value&&((t==null?void 0:t.scale)||e.scale)),d=M(()=>!s.value&&((t==null?void 0:t.move)||e.move)),u=M(()=>e.absolute??(t==null?void 0:t.absolute)??!0),i=M(()=>e.handler??(t==null?void 0:t.handler)??"dot"),h=M(()=>e.grid??(t==null?void 0:t.grid)),m=M(()=>e.diagonal??(t==null?void 0:t.diagonal)??!0),x=j(),c=E({}),r=Ye(c),S=Pe(),A=E(!1),$=E(!1),l=ee({x:0,y:0,width:0,height:0}),G=we(B),J={_rect:l,trigger:B};xe(x,()=>{o.value=!1});function W(a){return typeof a=="number"?a:parseFloat(a)}let D=!1;_e(()=>{e.width&&(l.width=e.width),e.height&&(l.height=e.height),e.x&&(l.x=e.x),e.y&&(l.y=e.y),D&&G(),D=!0});const U=ae(x),X=C(U.height,a=>{a&&(l.height=a,X())}),L=C(U.width,a=>{a&&(l.width=a,L())});be(async()=>{t==null||t.register(S,J),await De();const a=x.value.getBoundingClientRect();l.width=l.width||a.width,l.width&&L(),l.height=l.height||a.height,l.height&&X(),l.x=l.x||0,l.y=l.y||0,B(),Z()});function B(){const{x:a,y:g,width:f,height:v}=l;c.value={transform:`translate(${a}px, ${g}px)`,width:f,height:v}}const ne=M(()=>t&&Array.isArray(t.scale)?t.scale:e.scale),ue=M(()=>de.value?Array.isArray(ne.value)?ne.value:ze:[]),ce={l:"w",r:"e",t:"n",b:"s"},de=j(!0);function he(a,g){var b;if(a.stopPropagation(),a.preventDefault(),$.value||(A.value=!0,o.value=!0,((b=e.onDragStart)==null?void 0:b.call(e))===!1))return;const{clientX:v,clientY:_}=a;We(v,_,l,g,m.value,h.value,{onMove(){oe(l)&&(N.emit("move",S),B())},onUp(){var w;(w=e.onDragEnd)==null||w.call(e),A.value=!1,N.emit("moveup",S),Z()}})}function Z(){n("update:x",l.x),n("update:y",l.y),n("update:width",l.width),n("update:height",l.height)}function fe(a){if(!c.value)return{};const{width:g,height:f}=c.value,v=/l/.test(a),_=/r/.test(a),b=/t/.test(a);let w,k;return a.length===2?(w=v?0:g,k=b?0:f):v||_?(w=v?0:g,k=Number(f)/2):(w=Number(g)/2,k=b?0:f),{top:i.value==="dot"?k:k-3+"px",left:i.value==="dot"?w:w-3+"px",cursor:a.split("").reverse().map(K=>ce[K]).join("")+"-resize"}}function ye(a){var b;if(a.stopPropagation(),A.value||!d.value||($.value=!0,o.value=!0,((b=e.onDragStart)==null?void 0:b.call(e))===!1))return;const f=me(c.value),v=w=>{const{clientX:k,clientY:K}=w,ge=k-a.clientX+f.x,pe=K-a.clientY+f.y;l.x=ge,l.y=pe,l.width=f.width,l.height=f.height,oe(l)&&(N.emit("move",S),B())},_=()=>{var w;(w=e.onDragEnd)==null||w.call(e),$.value=!1,N.emit("moveup",S),document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",_),Z(),n("select",l)};document.addEventListener("mousemove",v),document.addEventListener("mouseup",_)}function oe(a){if(t)return t.checkValid(a);if(e.limitWidth&&e.limitHeight){const{x:g,y:f,width:v,height:_}=a;return g>=0&&g+v<=e.limitWidth&&f>=0&&f+_<=e.limitHeight}else return!0}function me(a){const{transform:g,width:f,height:v}=a,{x:_,y:b}=ve(g);return{x:_?Number(_):0,y:b?Number(b):0,width:parseFloat(f),height:parseFloat(v)}}function ve(a){if(!a)return{x:0,y:0};const g=/translate\(([.0-9]+)px[, ]+([.0-9]+)px\)/,[,f,v]=g.exec(a)??[];return{x:W(f),y:W(v)}}return{widgetRef:x,canMove:d,wrapStyle:r,canScale:p,dots:ue,active:o,isAbsolute:u,isScale:A,handlerType:i,getDotPos:fe,onMousedown:ye,onMousedownDot:he}},render(){const e=this.canScale?this.dots.map(o=>V("div",{class:this.handlerType==="dot"?"free-dom__widget-dot":"free-dom__resizable-handler",style:this.getDotPos(o),onMousedown:t=>this.onMousedownDot(t,o)})):null,n=typeof this.$slots.default=="function"?this.$slots.default():this.$slots.default;return V("section",{ref:"widgetRef",class:["free-dom__widget-wrapper",{"is-scale":this.isScale},{"is-absolute":this.isAbsolute},{"can-move":this.canMove},{"is-active":this.active}],style:this.wrapStyle,onMousedown:this.onMousedown},[n,e])}}),Oe=["xt","xc","xb","yl","yc","yr"],je=q({setup(){const e=re(te),n=j(Oe),o=E(e.diff),t=e.nodes,s=ee({xt:{show:!1,pos:0},xc:{show:!1,pos:0},xb:{show:!1,pos:0},yl:{show:!1,pos:0},yc:{show:!1,pos:0},yr:{show:!1,pos:0}});N.on("move",async i=>{var m;const h=((m=t.find(x=>x.uuid===i))==null?void 0:m.node)??{};p(),t.forEach(x=>{if(x.uuid===i)return;const c=d(h._rect),r=d(x.node._rect);u(c.top,r.top)&&(s.xt={show:!0,pos:r.top},h._rect.y=r.top),u(c.bottom,r.top)&&(s.xt={show:!0,pos:r.top},h._rect.y=r.top-c.height),u(c.centerY,r.centerY)&&(s.xc={show:!0,pos:r.centerY},h._rect.y=r.centerY-c.height/2),u(c.top,r.bottom)&&(s.xb={show:!0,pos:r.bottom},h._rect.y=r.bottom),u(c.bottom,r.bottom)&&(s.xb={show:!0,pos:r.bottom},h._rect.y=r.bottom-c.height),u(c.left,r.left)&&(s.yl={show:!0,pos:r.left},h._rect.x=r.left),u(c.right,r.left)&&(s.yl={show:!0,pos:r.left},h._rect.x=r.left-c.width),u(c.centerX,r.centerX)&&(s.yc={show:!0,pos:r.centerX},h._rect.x=r.centerX-c.width/2),u(c.left,r.right)&&(s.yr={show:!0,pos:r.right},h._rect.x=r.right),u(c.right,r.right)&&(s.yr={show:!0,pos:r.right},h._rect.x=r.right-c.width)})}),N.on("moveup",p),Ue(()=>{N.off("move"),N.off("moveup")});function p(){s.xt.show=!1,s.xc.show=!1,s.xb.show=!1,s.yl.show=!1,s.yc.show=!1,s.yr.show=!1}function d(i){return{top:i.y,bottom:i.y+i.height,left:i.x,right:i.x+i.width,width:i.width,height:i.height,centerX:i.x+i.width/2,centerY:i.y+i.height/2}}function u(i,h){return Math.abs(i-h)<=o.value}return{lines:n,diff:o,lineStatus:s}},render(){const e=(o,t)=>V("div",{style:{[o.includes("x")?"top":"left"]:t.pos+"px"},class:[o.includes("x")?"free-dom__xline":"free-dom__yline","free-dom__line"]}),n=this.lines.filter(o=>this.lineStatus[o].show).map(o=>e(o,this.lineStatus[o]));return V("div",{class:"free-dom__mark-line"},n)}}),qe={absolute:{type:Boolean,default:void 0},preview:Boolean,move:Boolean,scale:[Boolean,Array],diff:{type:Number,default:3},handler:{type:String,default:void 0},diagonal:{type:Boolean,default:void 0},grid:{type:Object,default:void 0}},Ge=q({name:"FreeDomWrap",props:qe,setup(e){const n=j(null),o=ae(n),t=E([]);function s(d,u){t.value.push({uuid:d,node:u})}function p(d){const{x:u,y:i,width:h,height:m}=d;return u>=0&&u+h<=o.width.value&&i>=0&&i+m<=o.height.value}return Be(te,ee({...Me(e),nodes:t,register:s,checkValid:p})),{rectRef:n}},render(){const e=typeof this.$slots.default=="function"?this.$slots.default():this.$slots.default;return V("section",{ref:"rectRef"},[e,V(je)])}}),Je=Ie,Ze=Ge;const Ke=q({__name:"Home",setup(e){const n=E(!1),o=E([{text:"测试文本",x:50,style:{color:"#d1239d"}},{text:"测试文本",style:{fontSize:"24px"}}]);function t(){n.value=!n.value}function s(){o.value.push({text:"测试文本",style:{}})}function p(d){console.log(d)}return(d,u)=>(H(),O(Q,null,[Y("button",{onClick:s}," 添加 "),Y("button",{style:{"margin-left":"20px"},onClick:t},z(R(n)?"显示":"隐藏"),1),R(n)?Ae("",!0):(H(),O(Q,{key:0},[le(R(Ze),{move:"",scale:"",style:{width:"600px",height:"400px",border:"1px solid #999",position:"relative"}},{default:ie(()=>[(H(!0),O(Q,null,Ee(R(o),(i,h)=>(H(),Ne(R(Je),{key:h,x:i.x,"onUpdate:x":m=>i.x=m,y:i.y,"onUpdate:y":m=>i.y=m,width:i.width,"onUpdate:width":m=>i.width=m,height:i.height,"onUpdate:height":m=>i.height=m,scale:["rb"],style:Se(i.style),handler:"mark",onSelect:p},{default:ie(()=>[Y("div",null,[Y("span",null,z(i.text)+z(h),1)])]),_:2},1032,["x","onUpdate:x","y","onUpdate:y","width","onUpdate:width","height","onUpdate:height","style"]))),128))]),_:1}),Y("pre",null,z(R(o)),1)],64))],64))}}),tt=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"index.md"}'),Qe={name:"index.md"};function Ce(e,n,o,t,s,p){const d=Ke;return H(),O("div",null,[le(d)])}const nt=ke(Qe,[["render",Ce]]);export{tt as __pageData,nt as default};
