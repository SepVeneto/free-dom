import{d as J,r as U,b as D,s as q,e as G,f as me,u as ve,w as C,g as ye,h as X,i as pe,j as ge,p as we,t as _e,k as ie,l as $,o as T,c as j,m as H,n as I,F as Q,q as ae,v as ne,x as xe,y as be,z as De,A as Ue,_ as Me}from"./app.281b54c9.js";let O;const Ee=new Uint8Array(16);function Se(){if(!O&&(O=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!O))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return O(Ee)}const v=[];for(let e=0;e<256;++e)v.push((e+256).toString(16).slice(1));function Be(e,o=0){return(v[e[o+0]]+v[e[o+1]]+v[e[o+2]]+v[e[o+3]]+"-"+v[e[o+4]]+v[e[o+5]]+"-"+v[e[o+6]]+v[e[o+7]]+"-"+v[e[o+8]]+v[e[o+9]]+"-"+v[e[o+10]]+v[e[o+11]]+v[e[o+12]]+v[e[o+13]]+v[e[o+14]]+v[e[o+15]]).toLowerCase()}const Ne=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),se={randomUUID:Ne};function Ae(e,o,n){if(se.randomUUID&&!o&&!e)return se.randomUUID();e=e||{};const t=e.random||(e.rng||Se)();if(t[6]=t[6]&15|64,t[8]=t[8]&63|128,o){n=n||0;for(let i=0;i<16;++i)o[n+i]=t[i];return o}return Be(t)}var Le=Object.defineProperty,$e=(e,o,n)=>o in e?Le(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,ke=(e,o,n)=>($e(e,typeof o!="symbol"?o+"":o,n),n);function Re(e){const o=U({transition:"inherit"});return C(()=>e,n=>{const t=Object.entries($(n)).reduce((i,g)=>{const[d,u]=g;return typeof u=="number"?i[d]=`${u}px`:i[d]=u,i},{});o.value={...o.value,...t}},{deep:!0}),o}var V=class{static on(e,o){Array.isArray(V._callbacks[e])||(V._callbacks[e]=[]),V._callbacks[e].push(o)}static emit(e,...o){var n;(n=V._callbacks[e])==null||n.forEach(t=>t.apply(this,o))}static off(e){V._callbacks[e].length=0}},M=V;ke(M,"_callbacks",{});var ee=Symbol("Scene");function P(e,o,n=1/0){return Math.max(Math.min(e,n),o)}function Pe(e,o,n){const t=Math.round(o/e[0])*e[0],i=Math.round(n/e[1])*e[1];return[t,i]}var z=20;function ze(e,o,n,t,i,g,d){const u=t?/t/.test(t):!1,s=t?/l/.test(t):!1,c=t?/b/.test(t):!1,y=t?/r/.test(t):!1,_=t?t.length===2:!1,{width:h,height:a,x:E,y:A}=n,k=Z=>{const{clientX:W,clientY:Y}=Z;let x=W-e,b=Y-o;Array.isArray(g)&&([x,b]=Pe(g,x,b));const S=h/a,R=h+(s?-x:y?x:0),F=a+(u?-b:c?b:0);_&&i?Math.abs(x)>=Math.abs(b)?(n.x=E+(s?x:0),n.width=P(R,z),n.height=P(R/S,z)):(n.y=A+(u?b:0),n.height=P(F,z),n.width=P(F*S,z)):(n.x=E+(s?x:0),n.y=A+(u?b:0),n.width=P(R,z),n.height=P(F,z)),d&&d.onMove&&d.onMove()},l=()=>{document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",l),d&&d.onMove&&d.onUp()};document.addEventListener("mousemove",k),document.addEventListener("mouseup",l)}var Ve=["t","r","l","b","lt","lb","rt","rb"],Xe=J({name:"FreeDom",props:{x:{type:Number,default:void 0},y:{type:Number,default:void 0},width:{type:Number,default:void 0},height:{type:Number,default:void 0},absolute:{type:Boolean,default:void 0},scale:{type:[Boolean,Array],default:void 0},move:Boolean,preview:Boolean,limitWidth:{type:Number,default:void 0},limitHeight:{type:Number,default:void 0},handler:{type:String,default:void 0},diagonal:{type:Boolean,default:void 0},grid:{type:Object,default:void 0},onDragStart:{type:Function,default:void 0},onDragEnd:{type:Function,default:void 0}},emits:["update:x","update:y","update:width","update:height","select"],setup(e,{emit:o}){const n=U(!1),t=ie(ee,void 0),i=D(()=>(t==null?void 0:t.preview)||e.preview),g=D(()=>!i.value&&((t==null?void 0:t.scale)||e.scale)),d=D(()=>!i.value&&((t==null?void 0:t.move)||e.move)),u=D(()=>e.absolute??(t==null?void 0:t.absolute)??!0),s=D(()=>e.handler??(t==null?void 0:t.handler)??"dot"),c=D(()=>e.grid??(t==null?void 0:t.grid)),y=D(()=>e.diagonal??(t==null?void 0:t.diagonal)??!0),_=q(),h=U({}),a=Re(h),E=Ae(),A=U(!1),k=U(!1),l=G({}),Z={_rect:l,trigger:S};me(_,()=>{n.value=!1});let W=G(ve(_)),Y=!0,x=!0;const b=C(W,({width:r,height:f})=>{Y&&r&&(l.width=r),x&&f&&(l.height=f)});C([()=>e.width,()=>e.height,()=>e.x,()=>e.y],([r,f,m,p])=>{Y=r===l.width,x=f===l.height,!x&&!Y&&(b(),W=null),r&&(l.width=r),f&&(l.height=f),m&&(l.x=m),p&&(l.y=p),S()},{immediate:!0}),ye(async()=>{t==null||t.register(E,Z);const{offsetTop:r,offsetLeft:f}=_.value;l.x=l.x||f,l.y=l.y||r,S()});function S(){const{x:r,y:f,width:m,height:p}=l;h.value={transform:`translate(${r}px, ${f}px)`,width:m,height:p}}const R=D(()=>t&&Array.isArray(t.scale)?t.scale:e.scale),F=D(()=>re.value?Array.isArray(R.value)?R.value:Ve:[]),le={l:"w",r:"e",t:"n",b:"s"},re=q(!0);function ue(r,f){var N;if(r.stopPropagation(),r.preventDefault(),k.value||(A.value=!0,n.value=!0,((N=e.onDragStart)==null?void 0:N.call(e))===!1))return;const{clientX:p,clientY:B}=r;ze(p,B,l,f,y.value,c.value,{onMove(){oe(l)&&(M.emit("move",E),S())},onUp(){var w;(w=e.onDragEnd)==null||w.call(e),A.value=!1,M.emit("moveup",E),te()}})}function te(){o("update:x",l.x),o("update:y",l.y),o("update:width",l.width),o("update:height",l.height)}function de(r){const{width:f,height:m}=l,p=/l/.test(r),B=/r/.test(r),N=/t/.test(r);let w,L;return r.length===2?(w=p?0:f,L=N?0:m):p||B?(w=p?0:f,L=Number(m)/2):(w=Number(f)/2,L=N?0:m),{top:s.value==="dot"?L:L-3+"px",left:s.value==="dot"?w:w-3+"px",cursor:r.split("").reverse().map(K=>le[K]).join("")+"-resize"}}function ce(r){var N;if(r.stopPropagation(),A.value||!d.value||(k.value=!0,n.value=!0,((N=e.onDragStart)==null?void 0:N.call(e))===!1))return;const m={...l},p=w=>{const{clientX:L,clientY:K}=w,he=L-r.clientX+m.x,fe=K-r.clientY+m.y;l.x=he,l.y=fe,l.width=m.width,l.height=m.height,oe(l)&&(M.emit("move",E),S())},B=()=>{var w;(w=e.onDragEnd)==null||w.call(e),k.value=!1,M.emit("moveup",E),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",B),te(),o("select",l)};document.addEventListener("mousemove",p),document.addEventListener("mouseup",B)}function oe(r){if(t)return t.checkValid(r);if(e.limitWidth&&e.limitHeight){const{x:f,y:m,width:p,height:B}=r;return f>=0&&f+p<=e.limitWidth&&m>=0&&m+B<=e.limitHeight}else return!0}return{widgetRef:_,canMove:d,wrapStyle:a,canScale:g,dots:F,active:n,isAbsolute:u,isScale:A,handlerType:s,getDotPos:de,onMousedown:ce,onMousedownDot:ue}},render(){const e=this.canScale?this.dots.map(n=>X("div",{class:this.handlerType==="dot"?"free-dom__widget-dot":"free-dom__resizable-handler",style:this.getDotPos(n),onMousedown:t=>this.onMousedownDot(t,n)})):null,o=typeof this.$slots.default=="function"?this.$slots.default():this.$slots.default;return X("section",{ref:"widgetRef",class:["free-dom__widget-wrapper",{"is-scale":this.isScale},{"is-absolute":this.isAbsolute},{"can-move":this.canMove},{"is-active":this.active}],style:this.wrapStyle,onMousedown:this.onMousedown},[o,e])}}),Ye=["xt","xc","xb","yl","yc","yr"],Fe=J({setup(){const e=ie(ee),o=q(Ye),n=U(e.diff),t=e.nodes,i=G({xt:{show:!1,pos:0},xc:{show:!1,pos:0},xb:{show:!1,pos:0},yl:{show:!1,pos:0},yc:{show:!1,pos:0},yr:{show:!1,pos:0}});M.on("move",async s=>{var y;const c=((y=t.find(_=>_.uuid===s))==null?void 0:y.node)??{};g(),t.forEach(_=>{if(_.uuid===s)return;const h=d(c._rect),a=d(_.node._rect);u(h.top,a.top)&&(i.xt={show:!0,pos:a.top},c._rect.y=a.top),u(h.bottom,a.top)&&(i.xt={show:!0,pos:a.top},c._rect.y=a.top-h.height),u(h.centerY,a.centerY)&&(i.xc={show:!0,pos:a.centerY},c._rect.y=a.centerY-h.height/2),u(h.top,a.bottom)&&(i.xb={show:!0,pos:a.bottom},c._rect.y=a.bottom),u(h.bottom,a.bottom)&&(i.xb={show:!0,pos:a.bottom},c._rect.y=a.bottom-h.height),u(h.left,a.left)&&(i.yl={show:!0,pos:a.left},c._rect.x=a.left),u(h.right,a.left)&&(i.yl={show:!0,pos:a.left},c._rect.x=a.left-h.width),u(h.centerX,a.centerX)&&(i.yc={show:!0,pos:a.centerX},c._rect.x=a.centerX-h.width/2),u(h.left,a.right)&&(i.yr={show:!0,pos:a.right},c._rect.x=a.right),u(h.right,a.right)&&(i.yr={show:!0,pos:a.right},c._rect.x=a.right-h.width)})}),M.on("moveup",g),pe(()=>{M.off("move"),M.off("moveup")});function g(){i.xt.show=!1,i.xc.show=!1,i.xb.show=!1,i.yl.show=!1,i.yc.show=!1,i.yr.show=!1}function d(s){return{top:s.y,bottom:s.y+s.height,left:s.x,right:s.x+s.width,width:s.width,height:s.height,centerX:s.x+s.width/2,centerY:s.y+s.height/2}}function u(s,c){return Math.abs(s-c)<=n.value}return{lines:o,diff:n,lineStatus:i}},render(){const e=(n,t)=>X("div",{style:{[n.includes("x")?"top":"left"]:t.pos+"px"},class:[n.includes("x")?"free-dom__xline":"free-dom__yline","free-dom__line"]}),o=this.lines.filter(n=>this.lineStatus[n].show).map(n=>e(n,this.lineStatus[n]));return X("div",{class:"free-dom__mark-line"},o)}}),He={absolute:{type:Boolean,default:void 0},preview:Boolean,move:Boolean,scale:[Boolean,Array],diff:{type:Number,default:3},handler:{type:String,default:void 0},diagonal:{type:Boolean,default:void 0},grid:{type:Object,default:void 0}},Te=J({name:"FreeDomWrap",props:He,setup(e){const o=q(null),n=ge(o),t=U([]);function i(d,u){t.value.push({uuid:d,node:u})}function g(d){const{x:u,y:s,width:c,height:y}=d;return u>=0&&u+c<=n.width.value&&s>=0&&s+y<=n.height.value}return we(ee,G({..._e(e),nodes:t,register:i,checkValid:g})),{rectRef:o}},render(){const e=typeof this.$slots.default=="function"?this.$slots.default():this.$slots.default;return X("section",{ref:"rectRef"},[e,X(Fe)])}}),We=Xe,Ie=Te;const Oe=J({__name:"Home",setup(e){const o=U(!1),n=U([{text:"测试文本",x:50,style:{color:"#d1239d"}},{text:"测试文本",style:{fontSize:"24px"}}]);function t(){o.value=!o.value}function i(){n.value.push({text:"测试文本",style:{}})}function g(d){console.log(d)}return(d,u)=>(T(),j(Q,null,[H("button",{onClick:i}," 添加 "),H("button",{style:{"margin-left":"20px"},onClick:t},I($(o)?"显示":"隐藏"),1),$(o)?Ue("",!0):(T(),j(Q,{key:0},[ae($(Ie),{move:"",scale:"",style:{width:"600px",height:"400px",border:"1px solid #999",position:"relative"}},{default:ne(()=>[(T(!0),j(Q,null,xe($(n),(s,c)=>(T(),be($(We),{key:c,x:s.x,"onUpdate:x":y=>s.x=y,y:s.y,"onUpdate:y":y=>s.y=y,width:s.width,"onUpdate:width":y=>s.width=y,height:s.height,"onUpdate:height":y=>s.height=y,scale:["rb"],style:De(s.style),handler:"mark",onSelect:g},{default:ne(()=>[H("div",null,[H("span",null,I(s.text)+I(c),1)])]),_:2},1032,["x","onUpdate:x","y","onUpdate:y","width","onUpdate:width","height","onUpdate:height","style"]))),128))]),_:1}),H("pre",null,I($(n)),1)],64))],64))}}),Je=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"index.md"}'),je={name:"index.md"};function qe(e,o,n,t,i,g){const d=Oe;return T(),j("div",null,[ae(d)])}const Ze=Me(je,[["render",qe]]);export{Je as __pageData,Ze as default};
