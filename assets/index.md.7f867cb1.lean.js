import{d as V,r as b,b as X,s as F,e as O,f as oe,g as be,w as ce,n as Se,h as N,i as De,u as ke,p as Be,t as Ne,j as le,k,o as Y,c as I,l as z,m as T,q as se,v as ne,F as re,x as $e,y as Ee,_ as Le,z as Re}from"./app.75d9ea0a.js";let P;const Ue=new Uint8Array(16);function Me(){if(!P&&(P=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!P))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return P(Ue)}const p=[];for(let e=0;e<256;++e)p.push((e+256).toString(16).slice(1));function Xe(e,t=0){return(p[e[t+0]]+p[e[t+1]]+p[e[t+2]]+p[e[t+3]]+"-"+p[e[t+4]]+p[e[t+5]]+"-"+p[e[t+6]]+p[e[t+7]]+"-"+p[e[t+8]]+p[e[t+9]]+"-"+p[e[t+10]]+p[e[t+11]]+p[e[t+12]]+p[e[t+13]]+p[e[t+14]]+p[e[t+15]]).toLowerCase()}const Ye=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ie={randomUUID:Ye};function Ae(e,t,n){if(ie.randomUUID&&!t&&!e)return ie.randomUUID();e=e||{};const s=e.random||(e.rng||Me)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,t){n=n||0;for(let i=0;i<16;++i)t[n+i]=s[i];return t}return Xe(s)}var Pe=Object.defineProperty,Fe=(e,t,n)=>t in e?Pe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ve=(e,t,n)=>(Fe(e,typeof t!="symbol"?t+"":t,n),n);function He(e){const t=b({transition:"inherit"});return ce(()=>e,n=>{const s=Object.entries(k(n)).reduce((i,w)=>{const[f,a]=w;return typeof a=="number"?i[f]=`${a}px`:i[f]=a,i},{});t.value={...t.value,...s}},{deep:!0}),t}var B=class{static on(e,t){Array.isArray(B._callbacks[e])||(B._callbacks[e]=[]),B._callbacks[e].push(t)}static emit(e,...t){var n;(n=B._callbacks[e])==null||n.forEach(s=>s.apply(this,t))}static off(e){B._callbacks[e].length=0}},S=B;Ve(S,"_callbacks",{});var j=Symbol("Scene"),We=["t","r","l","b","lt","lb","rt","rb"],ze=V({name:"FreeDom",props:{customStyle:{type:Object,required:!0},scale:{type:[Boolean,Array],default:void 0},move:Boolean,preview:Boolean,limitWidth:{type:Number,default:void 0},limitHeight:{type:Number,default:void 0}},emits:["update:customStyle","select"],setup(e,{emit:t}){const n=b(!1),s=le(j),i=X(()=>(s==null?void 0:s.preview)||e.preview),w=X(()=>!i.value&&((s==null?void 0:s.scale)||e.scale)),f=X(()=>!i.value&&((s==null?void 0:s.move)||e.move)),a=F(),c=b({}),u=He(c),y=Ae(),D=b(!1),d=b(!1),o=O({x:0,y:0,width:0,height:0}),ae={_rect:o,trigger:$};oe(()=>{s==null||s.register(y,ae)}),be(a,()=>{n.value=!1});function q(r){const{transform:l,width:h,height:m}=r,{x:v,y:g}=K(l);o.width=A(h??0),o.height=A(m??0),o.x=v,o.y=g}function A(r){return typeof r=="number"?r:parseFloat(r)}ce(()=>e.customStyle,r=>{q(r),$()}),oe(async()=>{c.value=e.customStyle,await Se();const r=a.value.getBoundingClientRect();q(e.customStyle),o.width=r.width,o.height=r.height,$()});function $(){const{x:r,y:l,width:h,height:m}=o;c.value={...e.customStyle,transform:`translate(${r}px, ${l}px)`,width:h,height:m}}const C=X(()=>s&&Array.isArray(s.scale)?s.scale:e.scale),ue=X(()=>he.value?Array.isArray(C.value)?C.value:We:[]),de={l:"w",r:"e",t:"n",b:"s"},he=F(!0);function me(r,l){if(r.stopPropagation(),r.preventDefault(),d.value)return;D.value=!0;const{x:h,y:m,width:v,height:g}=G(c.value),x=v,_=g,E=r.clientX,ye=r.clientY,H=/t/.test(l),W=/l/.test(l),ve=/b/.test(l),we=/r/.test(l),ge=l.length===2,Q=ee=>{const xe=ee.clientX,_e=ee.clientY,L=xe-E,R=_e-ye,te=x/_,U=x+(W?-L:we?L:0),M=_+(H?-R:ve?R:0);ge?Math.abs(L)>=Math.abs(R)?(o.x=h+(W?L:0),o.width=U<0?0:U,o.height=U/te):(o.y=m+(H?R:0),o.height=M<0?0:M,o.width=M*te):(o.x=h+(W?L:0),o.y=m+(H?R:0),o.width=U<0?0:U,o.height=M<0?0:M),J(o)&&(S.emit("move",y),$())},Z=()=>{D.value=!1,S.emit("moveup",y),document.removeEventListener("mousemove",Q),document.removeEventListener("mouseup",Z),t("update:customStyle",c.value)};document.addEventListener("mousemove",Q),document.addEventListener("mouseup",Z)}function fe(r){if(!c.value)return{};const{width:l,height:h}=c.value,m=/l/.test(r),v=/r/.test(r),g=/t/.test(r);let x,_;return r.length===2?(x=m?0:l,_=g?0:h):m||v?(x=m?0:l,_=Number(h)/2):(x=Number(l)/2,_=g?0:h),{top:_+"px",left:x+"px",cursor:r.split("").reverse().map(E=>de[E]).join("")+"-resize"}}function pe(r){if(r.stopPropagation(),D.value||!f.value)return;d.value=!0,n.value=!0;const l=G(c.value),h=v=>{const{clientX:g,clientY:x}=v,_=g-r.clientX+l.x,E=x-r.clientY+l.y;o.x=_,o.y=E,o.width=l.width,o.height=l.height,J(o)&&(S.emit("move",y),$())},m=()=>{d.value=!1,S.emit("moveup",y),document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",m),t("update:customStyle",c.value),t("select",o)};document.addEventListener("mousemove",h),document.addEventListener("mouseup",m)}function J(r){if(s)return s.checkValid(r);if(e.limitWidth&&e.limitHeight){const{x:l,y:h,width:m,height:v}=r;return l>=0&&l+m<=e.limitWidth&&h>=0&&h+v<=e.limitHeight}else return!0}function G(r){const{transform:l,width:h,height:m}=r,{x:v,y:g}=K(l);return{x:v?Number(v):0,y:g?Number(g):0,width:parseFloat(h),height:parseFloat(m)}}function K(r){if(!r)return{x:0,y:0};const l=/translate\(([.0-9]+)px[, ]+([.0-9]+)px\)/,[,h,m]=l.exec(r)??[];return{x:A(h),y:A(m)}}return{widgetRef:a,canMove:f,wrapStyle:u,canScale:w,dots:ue,active:n,getDotPos:fe,onMousedown:pe,onMousedownDot:me}},render(){const e=this.canScale?this.dots.map(n=>N("div",{class:"free-dom__widget-dot",style:this.getDotPos(n),onMousedown:s=>this.onMousedownDot(s,n)})):null,t=typeof this.$slots.default=="function"?this.$slots.default():this.$slots.default;return N("section",{ref:"widgetRef",class:["free-dom__widget-wrapper",{"can-move":this.canMove},{"is-active":this.active}],style:this.wrapStyle,onMousedown:this.onMousedown},[e,t])}}),Te=["xt","xc","xb","yl","yc","yr"],Ie=V({setup(){const e=le(j),t=F(Te),n=b(e.diff),s=e.nodes,i=O({xt:{show:!1,pos:0},xc:{show:!1,pos:0},xb:{show:!1,pos:0},yl:{show:!1,pos:0},yc:{show:!1,pos:0},yr:{show:!1,pos:0}});S.on("move",async c=>{var y;const u=((y=s.find(D=>D.uuid===c))==null?void 0:y.node)??{};w(),s.forEach(D=>{if(D.uuid===c)return;const d=f(u._rect),o=f(D.node._rect);a(d.top,o.top)&&(i.xt={show:!0,pos:o.top},u._rect.y=o.top),a(d.bottom,o.top)&&(i.xt={show:!0,pos:o.top},u._rect.y=o.top-d.height),a(d.centerY,o.centerY)&&(i.xc={show:!0,pos:o.centerY},u._rect.y=o.centerY-d.height/2),a(d.top,o.bottom)&&(i.xb={show:!0,pos:o.bottom},u._rect.y=o.bottom),a(d.bottom,o.bottom)&&(i.xb={show:!0,pos:o.bottom},u._rect.y=o.bottom-d.height),a(d.left,o.left)&&(i.yl={show:!0,pos:o.left},u._rect.x=o.left),a(d.right,o.left)&&(i.yl={show:!0,pos:o.left},u._rect.x=o.left-d.width),a(d.centerX,o.centerX)&&(i.yc={show:!0,pos:o.centerX},u._rect.x=o.centerX-d.width/2),a(d.left,o.right)&&(i.yr={show:!0,pos:o.right},u._rect.x=o.right),a(d.right,o.right)&&(i.yr={show:!0,pos:o.right},u._rect.x=o.right-d.width)})}),S.on("moveup",w),De(()=>{S.off("move"),S.off("moveup")});function w(){i.xt.show=!1,i.xc.show=!1,i.xb.show=!1,i.yl.show=!1,i.yc.show=!1,i.yr.show=!1}function f(c){return{top:c.y,bottom:c.y+c.height,left:c.x,right:c.x+c.width,width:c.width,height:c.height,centerX:c.x+c.width/2,centerY:c.y+c.height/2}}function a(c,u){return Math.abs(c-u)<=n.value}return{lines:t,diff:n,lineStatus:i}},render(){const e=(n,s)=>N("div",{style:{[n.includes("x")?"top":"left"]:s.pos+"px"},class:[n.includes("x")?"free-dom__xline":"free-dom__yline","free-dom__line"]}),t=this.lines.filter(n=>this.lineStatus[n].show).map(n=>e(n,this.lineStatus[n]));return N("div",{class:"free-dom__mark-line"},t)}}),Oe={preview:Boolean,move:Boolean,scale:[Boolean,Array],diff:{type:Number,default:3}},je=V({name:"FreeDomWrap",props:Oe,setup(e){const t=F(null),n=ke(t),s=b([]);function i(f,a){s.value.push({uuid:f,node:a})}function w(f){const{x:a,y:c,width:u,height:y}=f;return a>=0&&a+u<=n.width.value&&c>=0&&c+y<=n.height.value}return Be(j,O({...Ne(e),nodes:s,register:i,checkValid:w})),{rectRef:t}},render(){const e=typeof this.$slots.default=="function"?this.$slots.default():this.$slots.default;return N("section",{ref:"rectRef"},[e,N(Ie)])}}),qe=ze,Ce=je;const Je=V({__name:"Home",setup(e){const t=b(!1),n=b([{text:"测试文本",style:{color:"#d1239d"}},{text:"测试文本",style:{fontSize:"24px"}}]);function s(){t.value=!t.value}function i(){n.value.push({text:"测试文本",style:{}})}function w(f){console.log(f)}return(f,a)=>(Y(),I(re,null,[z("button",{onClick:i}," 添加 "),z("button",{style:{"margin-left":"20px"},onClick:s},T(k(t)?"显示":"隐藏"),1),k(t)?Ee("",!0):(Y(),se(k(Ce),{key:0,move:"",scale:["lt","lb","rt","rb"],style:{width:"600px",height:"400px",border:"1px solid #999",position:"relative"}},{default:ne(()=>[(Y(!0),I(re,null,$e(k(n),(c,u)=>(Y(),se(k(qe),{key:u,"custom-style":c.style,"onUpdate:custom-style":y=>c.style=y,onSelect:w},{default:ne(()=>[z("span",null,T(c.text)+T(u),1)]),_:2},1032,["custom-style","onUpdate:custom-style"]))),128))]),_:1}))],64))}}),Ze=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"index.md"}'),Ge={name:"index.md"};function Ke(e,t,n,s,i,w){const f=Je;return Y(),I("div",null,[Re(f)])}const et=Le(Ge,[["render",Ke]]);export{Ze as __pageData,et as default};
