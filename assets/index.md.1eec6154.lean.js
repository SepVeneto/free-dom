import{d as q,r as M,b,s as j,e as C,u as he,f as fe,w as pe,g as me,n as ye,h as F,i as ve,j as ge,p as we,t as xe,k as _e,l as se,m as k,o as Y,c as O,q as H,v as I,F as Q,x as ie,y as oe,z as be,A as Me,B as Ue,C as Be,_ as De}from"./app.8638193c.js";let W;const Ne=new Uint8Array(16);function Ee(){if(!W&&(W=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!W))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return W(Ne)}const m=[];for(let e=0;e<256;++e)m.push((e+256).toString(16).slice(1));function Ae(e,o=0){return(m[e[o+0]]+m[e[o+1]]+m[e[o+2]]+m[e[o+3]]+"-"+m[e[o+4]]+m[e[o+5]]+"-"+m[e[o+6]]+m[e[o+7]]+"-"+m[e[o+8]]+m[e[o+9]]+"-"+m[e[o+10]]+m[e[o+11]]+m[e[o+12]]+m[e[o+13]]+m[e[o+14]]+m[e[o+15]]).toLowerCase()}const Se=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ne={randomUUID:Se};function ke(e,o,n){if(ne.randomUUID&&!o&&!e)return ne.randomUUID();e=e||{};const t=e.random||(e.rng||Ee)();if(t[6]=t[6]&15|64,t[8]=t[8]&63|128,o){n=n||0;for(let i=0;i<16;++i)o[n+i]=t[i];return o}return Ae(t)}var Re=Object.defineProperty,$e=(e,o,n)=>o in e?Re(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,Le=(e,o,n)=>($e(e,typeof o!="symbol"?o+"":o,n),n);function Pe(e){const o=M({transition:"inherit"});return _e(()=>e,n=>{const t=Object.entries(k(n)).reduce((i,g)=>{const[d,u]=g;return typeof u=="number"?i[d]=`${u}px`:i[d]=u,i},{});o.value={...o.value,...t}},{deep:!0}),o}var P=class{static on(e,o){Array.isArray(P._callbacks[e])||(P._callbacks[e]=[]),P._callbacks[e].push(o)}static emit(e,...o){var n;(n=P._callbacks[e])==null||n.forEach(t=>t.apply(this,o))}static off(e){P._callbacks[e].length=0}},U=P;Le(U,"_callbacks",{});var ee=Symbol("Scene");function $(e,o,n=1/0){return Math.max(Math.min(e,n),o)}function Fe(e,o,n){const t=Math.round(o/e[0])*e[0],i=Math.round(n/e[1])*e[1];return[t,i]}var L=20;function Te(e,o,n,t,i,g,d){const u=t?/t/.test(t):!1,s=t?/l/.test(t):!1,h=t?/b/.test(t):!1,y=t?/r/.test(t):!1,x=t?t.length===2:!1,{width:c,height:a,x:B,y:N}=n,R=G=>{const{clientX:J,clientY:z}=G;let _=J-e,w=z-o;Array.isArray(g)&&([_,w]=Fe(g,_,w));const T=c/a,V=c+(s?-_:y?_:0),X=a+(u?-w:h?w:0);x&&i?Math.abs(_)>=Math.abs(w)?(n.x=B+(s?_:0),n.width=$(V,L),n.height=$(V/T,L)):(n.y=N+(u?w:0),n.height=$(X,L),n.width=$(X*T,L)):(n.x=B+(s?_:0),n.y=N+(u?w:0),n.width=$(V,L),n.height=$(X,L)),d&&d.onMove&&d.onMove()},l=()=>{document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",l),d&&d.onMove&&d.onUp()};document.addEventListener("mousemove",R),document.addEventListener("mouseup",l)}var Ve=["t","r","l","b","lt","lb","rt","rb"],Xe=q({name:"FreeDom",props:{x:{type:Number,default:0},y:{type:Number,default:0},width:{type:Number,default:0},height:{type:Number,default:0},absolute:{type:Boolean,default:void 0},scale:{type:[Boolean,Array],default:void 0},move:Boolean,preview:Boolean,limitWidth:{type:Number,default:void 0},limitHeight:{type:Number,default:void 0},handler:{type:String,default:void 0},diagonal:{type:Boolean,default:void 0},grid:{type:Object,default:void 0}},emits:["update:x","update:y","update:width","update:height","select"],setup(e,{emit:o}){const n=M(!1),t=se(ee),i=b(()=>(t==null?void 0:t.preview)||e.preview),g=b(()=>!i.value&&((t==null?void 0:t.scale)||e.scale)),d=b(()=>!i.value&&((t==null?void 0:t.move)||e.move)),u=b(()=>e.absolute??(t==null?void 0:t.absolute)??!0),s=b(()=>e.handler??(t==null?void 0:t.handler)??"dot"),h=b(()=>e.grid??(t==null?void 0:t.grid)),y=b(()=>e.diagonal??(t==null?void 0:t.diagonal)??!0),x=j(),c=M({}),a=Pe(c),B=ke(),N=M(!1),R=M(!1),l=C({x:0,y:0,width:0,height:0}),G=he(w),J={_rect:l,trigger:w};fe(x,()=>{n.value=!1});function z(r){return typeof r=="number"?r:parseFloat(r)}let _=!1;pe(()=>{l.width=e.width,l.height=e.height,l.x=e.x,l.y=e.y,_&&G(),_=!0}),me(async()=>{t==null||t.register(B,J),await ye();const r=x.value.getBoundingClientRect();l.width=l.width||r.width,l.height=l.height||r.height,l.x=l.x||0,l.y=l.y||0,w(),Z()});function w(){const{x:r,y:f,width:p,height:v}=l;c.value={transform:`translate(${r}px, ${f}px)`,width:p,height:v}}const T=b(()=>t&&Array.isArray(t.scale)?t.scale:e.scale),V=b(()=>ae.value?Array.isArray(T.value)?T.value:Ve:[]),X={l:"w",r:"e",t:"n",b:"s"},ae=j(!0);function re(r,f){if(r.stopPropagation(),r.preventDefault(),R.value)return;N.value=!0,n.value=!0;const{clientX:p,clientY:v}=r;Te(p,v,l,f,y.value,h.value,{onMove(){te(l)&&(U.emit("move",B),w())},onUp(){N.value=!1,U.emit("moveup",B),Z()}})}function Z(){o("update:x",l.x),o("update:y",l.y),o("update:width",l.width),o("update:height",l.height)}function le(r){if(!c.value)return{};const{width:f,height:p}=c.value,v=/l/.test(r),D=/r/.test(r),E=/t/.test(r);let A,S;return r.length===2?(A=v?0:f,S=E?0:p):v||D?(A=v?0:f,S=Number(p)/2):(A=Number(f)/2,S=E?0:p),{top:s.value==="dot"?S:S-3+"px",left:s.value==="dot"?A:A-3+"px",cursor:r.split("").reverse().map(K=>X[K]).join("")+"-resize"}}function ue(r){if(r.stopPropagation(),N.value||!d.value)return;R.value=!0,n.value=!0;const f=ce(c.value),p=D=>{const{clientX:E,clientY:A}=D,S=E-r.clientX+f.x,K=A-r.clientY+f.y;l.x=S,l.y=K,l.width=f.width,l.height=f.height,te(l)&&(U.emit("move",B),w())},v=()=>{R.value=!1,U.emit("moveup",B),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",v),Z(),o("select",l)};document.addEventListener("mousemove",p),document.addEventListener("mouseup",v)}function te(r){if(t)return t.checkValid(r);if(e.limitWidth&&e.limitHeight){const{x:f,y:p,width:v,height:D}=r;return f>=0&&f+v<=e.limitWidth&&p>=0&&p+D<=e.limitHeight}else return!0}function ce(r){const{transform:f,width:p,height:v}=r,{x:D,y:E}=de(f);return{x:D?Number(D):0,y:E?Number(E):0,width:parseFloat(p),height:parseFloat(v)}}function de(r){if(!r)return{x:0,y:0};const f=/translate\(([.0-9]+)px[, ]+([.0-9]+)px\)/,[,p,v]=f.exec(r)??[];return{x:z(p),y:z(v)}}return{widgetRef:x,canMove:d,wrapStyle:a,canScale:g,dots:V,active:n,isAbsolute:u,isScale:N,handlerType:s,getDotPos:le,onMousedown:ue,onMousedownDot:re}},render(){const e=this.canScale?this.dots.map(n=>F("div",{class:this.handlerType==="dot"?"free-dom__widget-dot":"free-dom__resizable-handler",style:this.getDotPos(n),onMousedown:t=>this.onMousedownDot(t,n)})):null,o=typeof this.$slots.default=="function"?this.$slots.default():this.$slots.default;return F("section",{ref:"widgetRef",class:["free-dom__widget-wrapper",{"is-scale":this.isScale},{"is-absolute":this.isAbsolute},{"can-move":this.canMove},{"is-active":this.active}],style:this.wrapStyle,onMousedown:this.onMousedown},[o,e])}}),Ye=["xt","xc","xb","yl","yc","yr"],ze=q({setup(){const e=se(ee),o=j(Ye),n=M(e.diff),t=e.nodes,i=C({xt:{show:!1,pos:0},xc:{show:!1,pos:0},xb:{show:!1,pos:0},yl:{show:!1,pos:0},yc:{show:!1,pos:0},yr:{show:!1,pos:0}});U.on("move",async s=>{var y;const h=((y=t.find(x=>x.uuid===s))==null?void 0:y.node)??{};g(),t.forEach(x=>{if(x.uuid===s)return;const c=d(h._rect),a=d(x.node._rect);u(c.top,a.top)&&(i.xt={show:!0,pos:a.top},h._rect.y=a.top),u(c.bottom,a.top)&&(i.xt={show:!0,pos:a.top},h._rect.y=a.top-c.height),u(c.centerY,a.centerY)&&(i.xc={show:!0,pos:a.centerY},h._rect.y=a.centerY-c.height/2),u(c.top,a.bottom)&&(i.xb={show:!0,pos:a.bottom},h._rect.y=a.bottom),u(c.bottom,a.bottom)&&(i.xb={show:!0,pos:a.bottom},h._rect.y=a.bottom-c.height),u(c.left,a.left)&&(i.yl={show:!0,pos:a.left},h._rect.x=a.left),u(c.right,a.left)&&(i.yl={show:!0,pos:a.left},h._rect.x=a.left-c.width),u(c.centerX,a.centerX)&&(i.yc={show:!0,pos:a.centerX},h._rect.x=a.centerX-c.width/2),u(c.left,a.right)&&(i.yr={show:!0,pos:a.right},h._rect.x=a.right),u(c.right,a.right)&&(i.yr={show:!0,pos:a.right},h._rect.x=a.right-c.width)})}),U.on("moveup",g),ve(()=>{U.off("move"),U.off("moveup")});function g(){i.xt.show=!1,i.xc.show=!1,i.xb.show=!1,i.yl.show=!1,i.yc.show=!1,i.yr.show=!1}function d(s){return{top:s.y,bottom:s.y+s.height,left:s.x,right:s.x+s.width,width:s.width,height:s.height,centerX:s.x+s.width/2,centerY:s.y+s.height/2}}function u(s,h){return Math.abs(s-h)<=n.value}return{lines:o,diff:n,lineStatus:i}},render(){const e=(n,t)=>F("div",{style:{[n.includes("x")?"top":"left"]:t.pos+"px"},class:[n.includes("x")?"free-dom__xline":"free-dom__yline","free-dom__line"]}),o=this.lines.filter(n=>this.lineStatus[n].show).map(n=>e(n,this.lineStatus[n]));return F("div",{class:"free-dom__mark-line"},o)}}),He={absolute:{type:Boolean,default:void 0},preview:Boolean,move:Boolean,scale:[Boolean,Array],diff:{type:Number,default:3},handler:{type:String,default:void 0},diagonal:{type:Boolean,default:void 0},grid:{type:Object,default:void 0}},Ie=q({name:"FreeDomWrap",props:He,setup(e){const o=j(null),n=ge(o),t=M([]);function i(d,u){t.value.push({uuid:d,node:u})}function g(d){const{x:u,y:s,width:h,height:y}=d;return u>=0&&u+h<=n.width.value&&s>=0&&s+y<=n.height.value}return we(ee,C({...xe(e),nodes:t,register:i,checkValid:g})),{rectRef:o}},render(){const e=typeof this.$slots.default=="function"?this.$slots.default():this.$slots.default;return F("section",{ref:"rectRef"},[e,F(ze)])}}),We=Xe,Oe=Ie;const je=q({__name:"Home",setup(e){const o=M(!1),n=M([{text:"测试文本",x:50,style:{color:"#d1239d"}},{text:"测试文本",style:{fontSize:"24px"}}]);function t(){o.value=!o.value}function i(){n.value.push({text:"测试文本",style:{}})}function g(d){console.log(d)}return(d,u)=>(Y(),O(Q,null,[H("button",{onClick:i}," 添加 "),H("button",{style:{"margin-left":"20px"},onClick:t},I(k(o)?"显示":"隐藏"),1),k(o)?Be("",!0):(Y(),O(Q,{key:0},[ie(k(Oe),{move:"",scale:"",style:{width:"600px",height:"400px",border:"1px solid #999",position:"relative"}},{default:oe(()=>[(Y(!0),O(Q,null,be(k(n),(s,h)=>(Y(),Me(k(We),{key:h,x:s.x,"onUpdate:x":y=>s.x=y,y:s.y,"onUpdate:y":y=>s.y=y,width:s.width,"onUpdate:width":y=>s.width=y,height:s.height,"onUpdate:height":y=>s.height=y,scale:["rb"],style:Ue(s.style),handler:"mark",onSelect:g},{default:oe(()=>[H("span",null,I(s.text)+I(h),1)]),_:2},1032,["x","onUpdate:x","y","onUpdate:y","width","onUpdate:width","height","onUpdate:height","style"]))),128))]),_:1}),H("pre",null,I(k(n)),1)],64))],64))}}),Ze=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"index.md"}'),qe={name:"index.md"};function Ge(e,o,n,t,i,g){const d=je;return Y(),O("div",null,[ie(d)])}const Ke=De(qe,[["render",Ge]]);export{Ze as __pageData,Ke as default};
