import{u as Re,a as me,b as ke,o as Ne}from"./theme.952ca5a3.js";import{r as D,o as ie,a0 as ye,e as P,c as z,C as Me,f as fe,h as Ee,x as Be,H as He,m as $e,l as Ve,J as Xe,O as Ye,u as ge,p as Le,i as We,F as Ae,a1 as j,N as re,E as Q,a2 as Z,$ as Oe,d as U,B as we,a3 as Ie,w as Pe,V as be,a4 as Te}from"./framework.8dee614b.js";function Ge(e){const n=D(1200);ie(()=>{t(),window.addEventListener("resize",l)}),ye(()=>{window.removeEventListener("resize",l)});const l=Re(t);function t(){var c;n.value=((c=e.value)==null?void 0:c.getBoundingClientRect().width)||1200}return n}const gt=P({__name:"vp-demo",props:{source:{},demos:{},path:{}},setup(e){const n=D(),l=Ge(n),t=e,c=z(()=>t.path.startsWith("grid-layout")),d=z(()=>({border:"1px solid black",width:c.value?"":"100%",height:c.value?"":"300px"})),x=z(()=>{const i=Object.keys(t.demos);for(const s of i)if(s.replace("../examples/","").replace(".vue","")===t.path)return t.demos[s].default;return!1});return(i,s)=>{const m=Me("ClientOnly");return fe(),Ee(Ae,null,[Be("section",{ref_key:"wrapRef",ref:n,style:{width:"100%"}},[He(m,null,{default:$e(()=>[x.value?(fe(),Ve(Xe(x.value),{key:0,style:Ye(d.value),width:ge(l)},null,8,["style","width"])):Le("",!0)]),_:1})],512),We(i.$slots,"source")],64)}}});const ue=Symbol("Scene");function A(e,n={},l={},t={}){if(!e)return()=>null;const c=je(t),d={...n,...l,...c};return x=>j(e,d,x)}const Ke=/^nativeOn([A-Z]\S*)/;function je(e){const n={};let l=!1;Object.entries(e).forEach(([c,d])=>{{l=!0;const x=c.replace(Ke,(i,s)=>`on${s}`);n[x]=d}});const t={};return l&&(t.on=n),t.on}function I(e,n,l=1/0){return Math.max(Math.min(e,l),n)}function ae(...e){}function pe(e){if(e){if(!e.getElementById("free-dom-style-el")){const n=e.createElement("style");n.id="free-dom-style-el",n.innerHTML=".free-dom-transparent-selection *::selection {all: inherit;}",e.getElementsByTagName("head")[0].appendChild(n)}e.body&&e.body.classList.add("free-dom-transparent-selection")}}function oe(e){if(!e)return;e.body&&e.body.classList.remove("free-dom-transparent-selection");const n=e.getSelection();n&&n.removeAllRanges()}const qe=["xt","xc","xb","yl","yc","yr"],Je=P({props:{showLine:Boolean},setup(){const e=re(ue),n=Q(qe),l=z(()=>e.diff/e.transformScale),t=e.nodes,c=z(()=>t.filter(h=>!h.node.selected)),d=Z({xt:{show:!1,pos:0},xc:{show:!1,pos:0},xb:{show:!1,pos:0},yl:{show:!1,pos:0},yc:{show:!1,pos:0},yr:{show:!1,pos:0}}),x=(h,w)=>{var R;const F=(R=t.find(M=>M.uuid===h))==null?void 0:R.node;F&&(i(),c.value.forEach(M=>{if(M.uuid===h)return;const g=s(F._rect),v=s(M.node._rect);m(g.top,v.top,w)&&(d.xt={show:!0,pos:v.top},F._rect.y=v.top),m(g.bottom,v.top,w)&&(d.xt={show:!0,pos:v.top},F._rect.y=v.top-g.height),m(g.centerY,v.centerY,w)&&(d.xc={show:!0,pos:v.centerY},F._rect.y=v.centerY-g.height/2),m(g.top,v.bottom,w)&&(d.xb={show:!0,pos:v.bottom},F._rect.y=v.bottom),m(g.bottom,v.bottom,w)&&(d.xb={show:!0,pos:v.bottom},F._rect.y=v.bottom-g.height),m(g.left,v.left,w)&&(d.yl={show:!0,pos:v.left},F._rect.x=v.left),m(g.right,v.left,w)&&(d.yl={show:!0,pos:v.left},F._rect.x=v.left-g.width),m(g.centerX,v.centerX,w)&&(d.yc={show:!0,pos:v.centerX},F._rect.x=v.centerX-g.width/2),m(g.left,v.right,w)&&(d.yr={show:!0,pos:v.right},F._rect.x=v.right),m(g.right,v.right,w)&&(d.yr={show:!0,pos:v.right},F._rect.x=v.right-g.width)}))};e==null||e.on("move",x),e==null||e.on("moveup",i),ye(()=>{e==null||e.off("move"),e==null||e.off("moveup")});function i(){d.xt.show=!1,d.xc.show=!1,d.xb.show=!1,d.yl.show=!1,d.yc.show=!1,d.yr.show=!1}function s(h){return{deltaX:h.deltaX,deltaY:h.deltaY,top:h.y,bottom:h.y+h.height,left:h.x,right:h.x+h.width,width:h.width,height:h.height,centerX:h.x+h.width/2,centerY:h.y+h.height/2}}function m(h,w,F){const R=F?0:l.value;return Math.abs(h-w)<=R}return{lines:n,diff:l,lineStatus:d}},render(){const e=(l,t)=>j("div",{style:{[l.includes("x")?"top":"left"]:t.pos+"px"},class:[l.includes("x")?"vv-free-dom--xline":"vv-free-dom--yline","vv-free-dom--line"]}),n=this.showLine?this.lines.filter(l=>this.lineStatus[l].show).map(l=>e(l,this.lineStatus[l])):[];return j("div",{class:"vv-free-dom--markline"},n)}});function C(){const e=Oe(),n=typeof e.default=="function"?e.default():e.default,l=n==null?void 0:n[0];return{slots:n,only:l}}function Ue(e){const n=D(NaN),l=D(NaN);function t(c,d){const x=isNaN(n.value),i=ge(e);if(!i)throw new Error("drag node does not exist");return x?{node:i,deltaX:0,deltaY:0,lastX:c,lastY:d,x:c,y:d}:{node:i,deltaX:c-n.value,deltaY:d-l.value,lastX:n.value,lastY:l.value,x:c,y:d}}return{lastX:n,lastY:l,create:t}}function Ze(e){const n=D(e.x||e.modelValue.x||0),l=D(e.y||e.modelValue.y||0),t=D(0),c=D(0),d=D();U(()=>{n.value=e.x||e.modelValue.x||0}),U(()=>{l.value=e.y||e.modelValue.y||0});const x=(h,w)=>{e.dragStartFn(h,w)},i=(h,w)=>{n.value=w.x,l.value=w.y,t.value=w.deltaX,c.value=w.deltaY,e.dragFn(h,w)},s=(h,w)=>{const F=d.value=m(w);e.dragStopFn(h,F)};function m(h){return{node:h.node,x:n.value+h.deltaX,y:l.value+h.deltaY,deltaX:h.deltaX,deltaY:h.deltaY,lastX:n.value,lastY:l.value}}return{x:n,y:l,deltaX:t,deltaY:c,create:m,handleDragStart:x,handleDrag:i,handleDragStop:s}}let Qe=0;function Ce(e,n,l){const t=re(ue,void 0),c=Qe++,d=z(()=>(t==null?void 0:t.handle)||l.handle),x=z(()=>(t==null?void 0:t.lockAspectRatio)||l.lockAspectRatio),i=z(()=>(t==null?void 0:t.minWidth)||l.minWidth),s=z(()=>(t==null?void 0:t.minHeight)||l.minHeight),m=z(()=>(t==null?void 0:t.disabledDrag)||l.disabledDrag),h=z(()=>(t==null?void 0:t.disabledResize)||l.disabledResize),w=z(()=>(t==null?void 0:t.disabledSelect)||l.disabledSelect),F=z(()=>(t==null?void 0:t.scale)||l.scale),R=z(()=>(t==null?void 0:t.transformScale)||l.transformScale),M=z(()=>(t==null?void 0:t.fixNonMonospaced)||l.fixNonMonospaced),g=z(()=>(t==null?void 0:t.keyboard)||l.keyboard);ie(()=>{const u=e.value;if(!u){console.warn("[free-dom] mounted failed: element not found");return}t==null||t.register(u.$el,c,n)}),we(()=>{t==null||t.remove(c)});function v(u){return t?t.checkValid(u):!0}function b(u){return t?t.correct(u):u}return{emit:(u,p)=>{t==null||t.emit(u,c,p)},check:v,correct:b,clearSelectState:t==null?void 0:t.clearSelectState,width:t==null?void 0:t.width,height:t==null?void 0:t.height,history:t==null?void 0:t.history,scale:F,handle:d,lockAspectRatio:x,minWidth:i,minHeight:s,disabledDrag:m,disabledResize:h,disabledSelect:w,fixNonMonospaced:M,transformScale:R,keyboard:g}}const q=D({});function ce(){return{on:(t,c)=>{q.value[t]?q.value[t].push(c):q.value[t]=[c]},off:t=>{q.value[t].length=0},emit:(t,...c)=>{(q.value[t]||[]).forEach(x=>x(...c))}}}function et(e,n){const l=D(c()),t=D(d());U(()=>{l.value=c()}),U(()=>{t.value=d()});function c(){return e.width||e.modelValue.w}function d(){return e.height||e.modelValue.h}async function x(i,s,m){if(e.width&&e.height||e.modelValue.w&&e.modelValue.h)return;if(!n.value)return[0,0];i&&await document.fonts.ready;const{width:h,height:w}=window.getComputedStyle(n.value.$el);l.value=Math.max(Math.ceil(parseFloat(h)),s),t.value=Math.max(Math.ceil(parseFloat(w)),m)}return{width:l,height:t,syncSize:x}}function tt(e){const n=Q(e.modelValue);U(()=>{n.value=e.modelValue});const l=z(()=>{var o;return(e.width-d.value[0]*(t.value-1)-(((o=i.value)==null?void 0:o[0])||d.value[0])*2)/e.cols}),t=z(()=>e.cols),c=z(()=>e.rowHeight),d=z(()=>e.margin),x=z(()=>e.maxRows),i=z(()=>e.containerPadding),s=z(()=>e.minW),m=z(()=>e.minH);function h(o){return n.value.find(a=>a.i===o)}function w(){return n.value}function F(o,a,f,y,_,E){if(a.static||a.y===y&&a.x===f)return o;ae(`Moving element ${a.i} to [${String(f)},${String(y)}] from [${a.x},${a.y}]`);const N=a.x,L=a.y;typeof f=="number"&&(a.x=f),typeof y=="number"&&(a.y=y),a.moved=!0;const X=v(o).filter(H=>b(H,a));return X.length>0&&E?(a.x=N,a.y=L,a.moved=!1,o):(X.forEach(H=>{ae(`Resolving collision between ${a.i} at [${a.x},${a.y}] and ${H.i} at [${H.x},${H.y}]`,H.moved,H.i),!H.moved&&(H.static?o=R(o,H,a,_):o=R(o,a,H,_))}),o)}function R(o,a,f,y){const _=a.static;if(y){y=!1;const E={x:f.x,y:Math.max(a.y-f.h,0),w:f.w,h:f.h,i:"-1"};if(!u(o,E))return ae(`Doing reverse collision on ${f.i} up to [${E.x},${E.y}].`),F(o,f,void 0,E.y,y,_)}return F(o,f,void 0,f.y+1,y,_)}function M(o,a,f){const _=F(n.value,o,a,f,!0,!e.collision);return n.value=p(_),n.value}function g(o,a,f){let y=!1;if(!e.collision){const _=n.value.filter(E=>b(E,{...o,w:a,h:f}));if(y=_.length>0,y){let E=1/0,N=1/0;_.forEach(L=>{L.x>o.x&&(E=Math.min(L.x,E)),L.y>o.y&&(N=Math.min(L.y,N))}),Number.isFinite(E)&&(o.w=E-o.x),Number.isFinite(N)&&(o.h=N-o.y)}}y||(o.w=a,o.h=f),n.value=p([...n.value])}function v(o){return o.slice(0).sort((a,f)=>a.y>f.y||a.y===f.y&&a.x>f.x?1:a.y===f.y&&a.x===f.x?0:-1)}function b(o,a){return o.i===a.i||o.x+o.w<=a.x||o.x>=a.x+a.w||o.y+o.h<=a.y?!1:!(o.y>=a.y+a.h)}function u(o,a){for(let f=0;f<o.length;++f)if(b(o[f],a))return o[f]}function p(o){const a=o.filter(_=>_.static),f=v(o),y=new Array(o.length);return f.forEach((_,E)=>{let N=JSON.parse(JSON.stringify(_));N.static||(N=r(a,N,f),a.push(N)),y[o.indexOf(f[E])]=N,N.moved=!1}),y}function r(o,a,f){if(e.collision)for(a.y=Math.min(S(o),a.y);a.y>0&&!u(o,a);)--a.y;let y;for(;(y=u(o,a))&&e.collision;)k(f,a,y.y+y.h,"y");return a}function S(o){let a=0;return o.forEach(f=>{const y=f.y+f.h;y>a&&(a=y)}),a}function $(){var a;if(!e.autoHeight)return;const o=S(n.value);return`${o*e.rowHeight+d.value[1]*(o-1)+(((a=i.value)==null?void 0:a[1])||d.value[1])*2}px`}const Y={x:"w",y:"h"};function k(o,a,f,y){const _=Y[y];a[y]+=1;const E=o.findIndex(N=>N===a);for(let N=E+1;N<o.length;++N){const L=o[N];if(L.y>a.y+a.h)break;b(a,L)&&k(o,L,f+a[_],y)}a[y]=f}return{cellWidth:l,cols:t,rowHeight:c,margin:d,maxRows:x,containerPadding:i,minW:s,minH:m,calContainerHeight:$,moveTo:M,resizeTo:g,getItem:h,getFull:w}}function at(e,n){const{cellWidth:l,margin:t,rowHeight:c,cols:d,maxRows:x,containerPadding:i}=n,s=D(),m=D(),h=z(()=>i.value||t.value),w=z(()=>s.value?Math.round(s.value.x):Math.round(e.x*(l.value+t.value[0])+h.value[0])),F=z(()=>s.value?Math.round(s.value.y):Math.round(e.y*(c.value+t.value[1])+h.value[1])),R=z(()=>m.value?Math.round(m.value.width):Math.round(l.value*e.width+Math.max(0,e.width-1)*t.value[0])),M=z(()=>m.value?Math.round(m.value.height):Math.round(c.value*e.height+Math.max(0,e.height-1)*t.value[1])),g=z(()=>{const a=n.minW.value;return Math.round(l.value*a+Math.max(0,a-1)*t.value[0])}),v=z(()=>{const a=n.minH.value;return Math.round(c.value*a+Math.max(0,a-1)*t.value[1])}),b=z(()=>({position:"absolute",width:`${R.value}px`,height:`${M.value}px`,transform:`translate(${w.value}px, ${F.value}px)`})),u=(a,{node:f})=>{const y=f.offsetParent.getBoundingClientRect(),_=f.getBoundingClientRect();s.value={x:_.left-y.left+f.offsetParent.scrollLeft,y:_.top-y.top+f.offsetParent.scrollTop}},p=(a,f)=>{if(!s.value)throw new Error("onDrag called before onDragStart");const{deltaX:y,deltaY:_}=f,E=s.value.x+y,N=s.value.y+_;s.value={x:E,y:N};const{x:L,y:B}=k(E,N);e.dragFn(a,{x:L,y:B})},r=a=>{if(!s.value)throw new Error("onDragStop called before onDratStart");const{x:f,y}=s.value,{x:_,y:E}=k(f,y);s.value=void 0,e.dragEndFn(a,{x:_,y:E})},S=(a,{width:f,height:y})=>{m.value={width:f,height:y}},$=(a,f)=>{const{width:y,height:_}=f,{w:E,h:N}=o(y,_);m.value={width:y,height:_},e.resizeFn(a,{w:E,h:N})},Y=(a,f)=>{m.value=void 0;const{width:y,height:_}=f,{w:E,h:N}=o(y,_);e.resizeStopFn(a,{w:E,h:N})};function k(a,f){let y=Math.round((a-t.value[0])/(l.value+t.value[0])),_=Math.round((f-t.value[1])/(c.value+t.value[1]));return y=I(y,0,d.value-e.width),_=I(_,0,x.value-e.height),{x:y,y:_}}function o(a,f){let y=Math.round((a+t.value[0])/(l.value+t.value[0])),_=Math.round((f+t.value[1])/(c.value+t.value[1]));return y=I(y,0,d.value-e.x),_=I(_,0,x.value-e.y),{w:y,h:_}}return{x:w,y:F,width:R,height:M,dragging:s,resizing:m,style:b,minWidth:g,minHeight:v,onDragStart:u,onDrag:p,onDragStop:r,onResizeStart:S,onResize:$,onResizeStop:Y}}function nt(e,n,l){const t=ce(),c=D(0),d=D(0),x=D(0),i=D(0),s=xe(l),m=D(!1),h=z(()=>{const k=x.value-c.value,o=i.value-d.value;return{visibility:w.value?"visible":"hidden",border:"2px solid rgb(0,120,215)",background:"rgb(0,120,215,0.3)",position:"absolute",top:d.value+(o<0?o:0)+"px",left:c.value+(k<0?k:0)+"px",width:Math.abs(k)+"px",height:Math.abs(o)+"px",zIndex:1}}),w=D(!1),F=me(e),R=z(()=>{var k;return(k=ke(e))==null?void 0:k.ownerDocument}),M=z(()=>l.value.filter(k=>!(n.disabledSelect||k.node.disabledSelect)));function g(){let k;M.value.forEach(o=>{const a=o.node._rect;if(a.x==null||a.y==null||a.width==null||a.height==null)return!1;const f=a.x,y=a.y,_=f+a.width,E=y+a.height,N=v(f,y,_,E);o.node.selected=N,N&&(k=o)}),k==null||k.el.focus()}function v(k,o,a,f){const y=Math.min(c.value,x.value),_=Math.min(d.value,i.value),E=Math.max(c.value,x.value),N=Math.max(d.value,i.value),L=b(y,E,k,a,Math.abs(k-a)/5),B=b(_,N,o,f,Math.abs(o-f)/5);return L&&B}function b(k,o,a,f,y){return Math.max(k,a)-Math.min(o,f)<=-y}function u(k){const o=k.clientX-F.x.value,a=k.clientY-F.y.value;return{x:o,y:a}}function p(k){if(n.disabledBatch)return;pe(R.value);const{x:o,y:a}=u(k);w.value=!0,c.value=o,d.value=a,x.value=o,i.value=a,document.addEventListener("mouseup",S)}function r(k){if(!w.value)return;m.value||(t.emit("batch-select","start"),m.value=!0);const{x:o,y:a}=u(k);x.value===o&&i.value===a||(x.value=o,i.value=a,Y())}function S(){oe(R.value),w.value=!1,m.value=!1,x.value===c.value&&i.value===d.value||s.push({type:"batch-select"}),document.removeEventListener("mouseup",S),x.value=0,i.value=0,c.value=0,d.value=0,setTimeout(()=>{t.emit("batch-select","end")})}function $(){return j("div",{id:"mask",style:h.value})}async function Y(){g()}return{selecting:w,renderMask:$,handleMousedown:p,handleMousemove:r}}const ne=D([]),lt=D({canClear:!1});function xe(e){const n=z(()=>{var t;return(t=ne.value.slice(-1)[0])==null?void 0:t.type});function l(t){ne.value.push({...t,data:e})}return{state:lt,records:ne,lastOperate:n,push:l}}function le(){}const st={userSelectHack:{type:Boolean,default:!0},startFn:{type:Function,default:le},stopFn:{type:Function,default:le},dragFn:{type:Function,default:le},disabled:Boolean,scale:{type:Number,default:1}},de=P({name:"FreeDomCore",props:st,setup(e){const n=D(!1),l=D(),t=z(()=>{var u;return((u=l.value)==null?void 0:u.$el)||l.value}),c=z(()=>{var u;return(u=t.value)==null?void 0:u.ownerDocument}),{lastX:d,lastY:x,create:i}=Ue(t),s=D(NaN),m=D(NaN);let h,w;we(()=>{c.value&&(e.userSelectHack&&oe(c.value),c.value.removeEventListener("mousemove",v),c.value.removeEventListener("mouseup",g))});function F(u){return M(u)}function R(u){g(u)}function M(u){var $,Y;if(e.disabled||!u.target||!(u.target instanceof t.value.ownerDocument.defaultView.Node))return;const{x:p,y:r}=b(u),S=i(p,r);e.startFn(u,S),s.value=p,m.value=r,d.value=p,x.value=r,n.value=!0,e.userSelectHack&&pe(c.value),($=c.value)==null||$.addEventListener("mousemove",v),(Y=c.value)==null||Y.addEventListener("mouseup",g)}function g(u){var p,r;if(n.value){if(!(s.value===d.value&&m.value===x.value)){const{x:S,y:$}=b(u),Y=i(S,$);e.stopFn(u,Y)}e.userSelectHack&&oe(c.value),n.value=!1,d.value=NaN,x.value=NaN,(p=c.value)==null||p.removeEventListener("mousemove",v),(r=c.value)==null||r.removeEventListener("mouseup",g)}}function v(u){const{x:p,y:r}=b(u),S=i(p,r);e.dragFn(u,S),d.value=p,x.value=r}function b(u){var Y;const p=((Y=t.value)==null?void 0:Y.offsetParent)||c.value.body,r=p===p.ownerDocument.body;(!h||h!==p)&&(h=p,w=r?{left:0,top:0}:p.getBoundingClientRect());const S=(u.clientX+p.scrollLeft-w.left)/e.scale,$=(u.clientY+p.scrollTop-w.top)/e.scale;return{x:S,y:$}}return{coreRef:l,mousedownFn:F,mouseupFn:R}},render(){const{only:e}=C(),n=A(e,{ref:l=>{this.coreRef=l}},{},{onMousedown:l=>{l.stopPropagation(),this.mousedownFn(l)},onMouseup:this.mouseupFn});return typeof n=="function"?n():n}}),ot=["t","r","l","b","lt","lb","rt","rb"];function se(){}const J={dragOpts:{type:Object,default:()=>({})},width:{type:Number,default:0},height:{type:Number,default:0},scale:{type:[Boolean,Array],default:void 0},startFn:{type:Function,default:se},stopFn:{type:Function,default:se},resizeFn:{type:Function,default:se},minWidth:{type:Number,default:50},minHeight:{type:Number,default:50},lockAspectRatio:Boolean},Fe=P({name:"ResizeDomCore",props:J,setup(e,{slots:n}){const l=z(()=>{const i=e.scale;return Array.isArray(i)?i:ot}),t=Q();function c(i,s){const{lockAspectRatio:m}=e;if(!e.minHeight&&!e.minWidth&&!m)return[i,s];if(m){const h=e.width/e.height;h>1?(s=Math.max(s,e.minHeight),i=s*h):(i=Math.max(i,e.minWidth),s=i/h)}else i=Math.max(i,e.minWidth),s=Math.max(s,e.minHeight);return[i,s]}function d(i,s){return(m,{node:h,deltaX:w,deltaY:F})=>{i==="start"&&(t.value=void 0);const R=s!=="t"&&s!=="b",M=s!=="l"&&s!=="r",g=s[0],v=s[s.length-1],b=h.getBoundingClientRect();t.value=b,g==="l"&&(w=-w),v==="t"&&(F=-F);let u=e.width+(R?w:0),p=e.height+(M?F:0);m.shiftKey||([u,p]=c(u,p));const r=u!==e.width||p!==e.height,S=`${i}Fn`,$=typeof e[S]=="function"?e[S]:null;$&&!(i==="resize"&&!r)&&$(m,{node:h,width:u,height:p,handle:s}),i==="stop"&&(t.value=void 0)}}function x(i){return n.handler?()=>{var s;return(s=n.handler)==null?void 0:s.call(n,i)}:()=>j("i",{dataType:"handler",class:["vv-resize-dom--handler",`vv-resize-dom--handler__${i}`]})}return{dots:l,handleResize:d,renderResizehandler:x}},render(){const{slots:e}=C(),n=[...e||[],this.dots.map(l=>A(de,{class:[this.dragOpts.disabled&&"vv-resize-dom--disabled"]},{...this.dragOpts,stopFn:this.handleResize("stop",l),startFn:this.handleResize("start",l),dragFn:this.handleResize("resize",l)})(this.renderResizehandler(l)))];return A("div",{class:"vv-resize-dom--box"})(n)}});function G(){}const O={modelValue:{type:Object,default:()=>({})},keyboard:Boolean,x:{type:Number,default:0},y:{type:Number,default:0},width:{type:Number,default:void 0},height:{type:Number,default:void 0},handle:{type:String,default:void 0},lockAspectRatio:Boolean,dragStartFn:{type:Function,default:G},dragStopFn:{type:Function,default:G},dragFn:{type:Function,default:G},resizeStartFn:{type:Function,default:G},resizeFn:{type:Function,default:G},resizeStopFn:{type:Function,default:G},autoSize:{type:Boolean,default:!0},minWidth:J.minWidth,minHeight:J.minHeight,disabledDrag:Boolean,disabledResize:Boolean,disabledSelect:Boolean,scale:J.scale,transformScale:{type:Number,default:1},fixNonMonospaced:Boolean},it=P({name:"FreeDom",props:O,emits:["update:width","update:height","update:x","update:y","update:modelValue"],setup(e,{emit:n,expose:l,slots:t}){const c=D(),d=D(!1);ce().on("batch-select",B=>{d.value=B==="start"});const{x:i,y:s,deltaX:m,deltaY:h,create:w,handleDragStart:F,handleDrag:R,handleDragStop:M}=Ze(e),{width:g,height:v,syncSize:b}=et(e,c),u=D(!1),p=Z({disabledSelect:Ie(e,"disabledSelect"),selected:u,_rect:Z({x:i,y:s,width:g,height:v,deltaX:m,deltaY:h}),trigger:B=>{n("update:modelValue",B)}}),r=Ce(c,p,e);Ne(c,()=>{!u.value||d.value||(u.value=!1)},{ignore:[r.clearSelectState&&".vv-free-dom--draggable"]});const S=()=>{b(r.fixNonMonospaced.value,r.minWidth.value,r.minHeight.value)},$=D(!1);ie(()=>{e.autoSize&&S()});const Y=z(()=>({width:`${g.value}px`,height:`${v.value}px`,transform:`translate(${i.value}px, ${s.value}px)`})),k=(B,X)=>{var T;if(!$.value)return;const V=w(X),H={x:V.x,y:V.y,width:g.value,height:v.value};(T=r.check)!=null&&T.call(r,H)&&(R(B,V),r.emit("move",B.shiftKey))},o=(B,X)=>{var W,T;if(!$.value)return;const V={x:i.value,y:s.value,width:g.value,height:v.value};((W=r.check)==null?void 0:W.call(r,V))||(i.value=I(i.value,0,r.width),s.value=I(s.value,0,r.height)),M(B,X),r.emit("moveup"),n("update:x",i.value),n("update:y",s.value),n("update:modelValue",{x:i.value,y:s.value,w:g.value,h:v.value}),(T=r.history)==null||T.push({type:"move-end"})},a=(B,X)=>{const V=r.handle.value;V?V.startsWith(".")?$.value=B.target.classList.contains(V.slice(1)):V.startsWith("#")?$.value=B.target.id===V.slice(1):(console.warn(`[free-dom] can not find element with ${V}`),$.value=!0):$.value=!0,$.value&&F(B,X)},f=(B,{node:X,width:V,height:H,handle:W})=>{var he;const T=-(V-g.value),ze=-(H-v.value),Se=W[0],De=W[W.length-1];let ee=i.value,te=s.value;Se==="l"&&(ee+=T),De==="t"&&(te+=ze),(he=r.check)!=null&&he.call(r,{x:ee,y:te,width:V,height:H})&&(g.value=V,v.value=H,i.value=ee,s.value=te,e.resizeFn(B,{node:X,width:V,height:H,handle:W}),r==null||r.emit("move"))},y=(B,X)=>{var H,W;((H=r.check)==null?void 0:H.call(r,{x:i.value,y:s.value,width:g.value,height:v.value}))||(i.value=I(i.value,0,r.width),s.value=I(s.value,0,r.height)),e.resizeStopFn(B,X),n("update:width",g.value),n("update:height",v.value),n("update:modelValue",{x:i.value,y:s.value,w:g.value,h:v.value}),r.emit("moveup"),(W=r.history)==null||W.push({type:"resize-end"})},_=(B,X)=>{e.resizeStartFn(B,X)},E=()=>{const B={width:g.value,height:v.value,lockAspectRatio:r.lockAspectRatio.value,dragOpts:{disabled:r.disabledResize.value,scale:r.transformScale.value},startFn:_,resizeFn:f,stopFn:y,minHeight:r.minHeight.value,minWidth:r.minWidth.value,scale:r.scale.value};return A(Fe,{},B)(t)};function N(B){var X,V,H;r.disabledSelect.value||(B.ctrlKey?(u.value=!u.value,(X=r.history)==null||X.push({type:"select"})):u.value||((V=r.clearSelectState)==null||V.call(r),u.value=!0,(H=r.history)==null||H.push({type:"select"})))}function L(B){var H;if(r.disabledDrag.value||!r.keyboard.value)return;switch(B.preventDefault(),B.key){case"ArrowUp":h.value=-1,m.value=0;break;case"ArrowDown":h.value=1,m.value=0;break;case"ArrowLeft":m.value=-1,h.value=0;break;case"ArrowRight":m.value=1,h.value=0;break;default:m.value=0,h.value=0}i.value+=m.value,s.value+=h.value;const X={x:i.value,y:s.value,width:g.value,height:v.value};((H=r.check)==null?void 0:H.call(r,X))||(i.value=I(i.value,0,r.width),s.value=I(s.value,0,r.height)),n("update:x",i.value),n("update:y",s.value),n("update:modelValue",{x:i.value,y:s.value,w:g.value,h:v.value}),r.emit("move",!0)}return l==null||l({syncSize:S}),{selected:u,domRef:c,style:Y,onDragStop:o,onDrag:k,onDragStart:a,resizeNode:E,handleKeyboard:L,handleSelect:N,disabled:r.disabledDrag,scale:r.transformScale}},render(){var l;const e={startFn:this.onDragStart,stopFn:this.onDragStop,dragFn:this.onDrag,disabled:this.disabled,scale:this.scale},n=()=>this.resizeNode();return(l=A(de,{ref:"domRef",tabindex:-1,class:["vv-free-dom--draggable",this.disabled&&"vv-free-dom--draggable__disabled",this.selected&&"vv-free-dom--draggable__selected"],style:this.style},e,{nativeOnClick:this.handleSelect,nativeOnKeydown:this.handleKeyboard}))==null?void 0:l(n)}}),rt={diff:{type:Number,default:2},showLine:{type:Boolean,default:!0},transformScale:{type:Number,default:1},keyboard:Boolean,disabledBatch:Boolean,handle:O.handle,minWidth:O.minWidth,minHeight:O.minHeight,lockAspectRatio:O.lockAspectRatio,disabledDrag:O.disabledDrag,disabledResize:O.disabledResize,disabledSelect:O.disabledSelect,scale:O.scale,fixNonMonospaced:O.fixNonMonospaced},ut=P({name:"FreeDomWrap",props:rt,setup(e){const n=ce(),l=D([]),t=xe(l),c=D(0),d=D(0),x=Q(),i=me(x);Pe([i.width,i.height,()=>l.value.length],([b,u])=>{c.value=b,d.value=u,!(!b||!u)&&w()});const s=z(()=>l.value.filter(b=>b.node.selected));n.on("move",b=>{const u=s.value.find(S=>S.uuid===b);if(!u)return;const{deltaX:p,deltaY:r}=u.node._rect;s.value.forEach(S=>{S.uuid!==b&&(S.node._rect.x+=p||0,S.node._rect.y+=r||0)})});const m=D(!1),h=nt(x,e,l);function w(){l.value.forEach(b=>{const{x:u,y:p,width:r,height:S}=g(b.node._rect);b.node._rect.x=u,b.node._rect.y=p,b.node._rect.width=r,b.node._rect.height=S,b.node.trigger({x:u,y:p,w:r,h:S})})}function F(b,u,p){l.value.push({el:b,uuid:u,node:p})}function R(b){const u=l.value.findIndex(p=>p.uuid===b);l.value.splice(u,1)}function M(b){const{x:u,y:p,width:r,height:S}=b;return u>=0&&u+r<=c.value&&p>=0&&p+S<=d.value}function g(b){let u=Math.max(b.x,0),p=Math.max(b.y,0),r=b.width,S=b.height;return b.x+b.width>c.value&&(u=c.value-b.width,u<0&&(r=c.value,u=0)),b.y+b.height>d.value&&(p=d.value-b.height,p<0&&(S=d.value,p=0)),{x:u,y:p,width:r,height:S}}function v(){s.value.forEach(b=>{b.node.selected=!1})}return be(ue,Z({...Te(e),nodes:l,width:c,height:d,history:t,clearSelectState:v,register:F,remove:R,checkValid:M,correct:g,on:n.on,off:n.off,emit:n.emit})),{rectRef:x,selecting:m,mask:h,history:t}},render(){const{slots:e}=C(),n=A(Je,{},{showLine:this.showLine})(),l=[this.mask.selecting&&this.mask.renderMask(),e,n];return A("section",{ref:"rectRef",class:"vv-free-dom--scene"},{},{onMousedown:this.mask.handleMousedown,onMousemove:this.mask.handleMousemove})(l)}}),_e=Symbol("gridLayoutContext"),K=()=>{},ct={x:{type:Number,required:!0},y:{type:Number,required:!0},width:{type:Number,required:!0},height:{type:Number,required:!0},dragStartFn:{type:Function,default:K},dragFn:{type:Function,default:K},dragEndFn:{type:Function,default:K},resizeStartFn:{type:Function,default:K},resizeFn:{type:Function,default:K},resizeStopFn:{type:Function,default:K},isDraggable:Boolean,isResizable:Boolean,scale:{type:J.scale.type,default:()=>["rb"]}},dt=["dragMove"],ve=P({name:"GridItem",props:ct,emits:dt,setup(e){const n=re(_e);if(!n)throw new Error("TODO");const{x:l,y:t,width:c,height:d,dragging:x,style:i,minWidth:s,minHeight:m,onDragStart:h,onDrag:w,onDragStop:F,onResizeStart:R,onResize:M,onResizeStop:g}=at(e,n),v=u=>{const p={width:c.value,height:d.value,scale:e.scale,dragOpts:{disabled:!e.isResizable},minWidth:s.value,minHeight:m.value,startFn:R,resizeFn:M,stopFn:g};return A(Fe,{},p)(()=>u)};return{x:l,y:t,width:c,height:d,style:i,dragging:x,onDragStart:h,onDrag:w,onDragStop:F,onResizeStart:R,onResize:M,onResizeStop:g,dragNode:u=>{const p={class:[x.value&&"vv-grid-layout--item__draggable","vv-grid-layout--item",!e.isDraggable&&"vv-grid-layout--item__disabled"],style:i.value},r={disabled:!e.isDraggable,startFn:h,stopFn:F,dragFn:w};return A(de,p,r)(()=>v(u))}}},render(){const{slots:e}=C(),n=e;return this.dragNode(n)}}),ht={modelValue:{type:Array,required:!0,default:()=>[]},autoHeight:{type:Boolean,default:!0},cols:{type:Number,default:12},maxRows:{type:Number,default:1/0},minW:{type:Number,default:1},minH:{type:Number,default:1},rowHeight:{type:Number,default:150},width:{type:Number,default:1200},margin:{type:Array,default:()=>[10,10]},containerPadding:{type:Array,default:void 0},disabledDrag:Boolean,disabledResize:Boolean,collision:Boolean},ft=P({name:"GridLayout",inheritAttrs:!1,props:ht,emits:["update:modelValue"],setup(e,{emit:n}){const l=tt(e);be(_e,l);const t=D(null);function c(x){const i=x.key;if(!i)return;const s=l.getItem(String(i));if(!s)return;const m=!s.static&&!e.disabledDrag,h=!s.static&&!e.disabledResize,w={x:s.x,y:s.y,width:s.w,height:s.h,isDraggable:m,isResizable:h,scale:s.scale,dragEndFn:(F,R)=>{const{x:M,y:g}=R,v=l.moveTo(s,M,g);n("update:modelValue",v),t.value=null},dragStartFn:()=>{},dragFn:(F,R)=>{if(!s)return;const M={x:s.x,y:s.y,width:s.w,height:s.h},{x:g,y:v}=R;l.moveTo(s,g,v),t.value=M},resizeFn:(F,R)=>{const M={x:s.x,y:s.y,width:s.w,height:s.h};t.value=M;const{w:g,h:v}=R;l.resizeTo(s,g,v)},resizeStopFn:(F,R)=>{const{w:M,h:g}=R;l.resizeTo(s,M,g),t.value=null}};return A(ve,{},w)({default:()=>x})}function d(){if(!t.value)return null;const{x,y:i,width:s,height:m}=t.value;return A(ve,{class:"vv-grid-layout--placeholder"},{x,y:i,width:s,height:m,move:!1})()}return{processItem:c,placeholder:d,layout:l}},render(){const e={...this.$attrs.style||{},height:this.layout.calContainerHeight()},n=typeof this.$slots.default=="function"?this.$slots.default():this.$slots.default||[];return j("div",{class:"vv-grid-layout",style:e},[n.map(this.processItem),this.placeholder()])}}),wt=ut,bt=ft,pt=it;export{pt as F,bt as G,gt as _,wt as a};
