import{d as j,r as _,b as D,s as O,e as Q,u as de,f as he,w as fe,g as pe,n as me,h as P,i as ye,j as ve,p as ge,t as we,k as xe,l as ne,m as k,o as X,c as W,q as z,v as H,F as K,x as se,y as te,z as _e,A as be,B as Ue,C as Be,_ as De}from"./app.8638193c.js";let I;const Me=new Uint8Array(16);function Ne(){if(!I&&(I=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!I))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return I(Me)}const v=[];for(let e=0;e<256;++e)v.push((e+256).toString(16).slice(1));function Se(e,t=0){return(v[e[t+0]]+v[e[t+1]]+v[e[t+2]]+v[e[t+3]]+"-"+v[e[t+4]]+v[e[t+5]]+"-"+v[e[t+6]]+v[e[t+7]]+"-"+v[e[t+8]]+v[e[t+9]]+"-"+v[e[t+10]]+v[e[t+11]]+v[e[t+12]]+v[e[t+13]]+v[e[t+14]]+v[e[t+15]]).toLowerCase()}const Ee=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),oe={randomUUID:Ee};function ke(e,t,n){if(oe.randomUUID&&!t&&!e)return oe.randomUUID();e=e||{};const o=e.random||(e.rng||Ne)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,t){n=n||0;for(let a=0;a<16;++a)t[n+a]=o[a];return t}return Se(o)}var Re=Object.defineProperty,$e=(e,t,n)=>t in e?Re(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ae=(e,t,n)=>($e(e,typeof t!="symbol"?t+"":t,n),n);function Le(e){const t=_({transition:"inherit"});return xe(()=>e,n=>{const o=Object.entries(k(n)).reduce((a,p)=>{const[d,u]=p;return typeof u=="number"?a[d]=`${u}px`:a[d]=u,a},{});t.value={...t.value,...o}},{deep:!0}),t}var L=class{static on(e,t){Array.isArray(L._callbacks[e])||(L._callbacks[e]=[]),L._callbacks[e].push(t)}static emit(e,...t){var n;(n=L._callbacks[e])==null||n.forEach(o=>o.apply(this,t))}static off(e){L._callbacks[e].length=0}},b=L;Ae(b,"_callbacks",{});var C=Symbol("Scene");function $(e,t,n=1/0){return Math.max(Math.min(e,n),t)}var A=20;function Pe(e,t,n,o,a,p){const d=o?/t/.test(o):!1,u=o?/l/.test(o):!1,i=o?/b/.test(o):!1,c=o?/r/.test(o):!1,m=o?o.length===2:!1,{width:w,height:h,x:s,y:M}=n,R=q=>{const{clientX:J,clientY:Y}=q,U=J-e,x=Y-t,F=w/h,T=w+(u?-U:c?U:0),V=h+(d?-x:i?x:0);m&&a?Math.abs(U)>=Math.abs(x)?(n.x=s+(u?U:0),n.width=$(T,A),n.height=$(T/F,A)):(n.y=M+(d?x:0),n.height=$(V,A),n.width=$(V*F,A)):(n.x=s+(u?U:0),n.y=M+(d?x:0),n.width=$(T,A),n.height=$(V,A)),p&&p.onMove&&p.onMove()},l=()=>{document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",l),p&&p.onMove&&p.onUp()};document.addEventListener("mousemove",R),document.addEventListener("mouseup",l)}var Fe=["t","r","l","b","lt","lb","rt","rb"],Te=j({name:"FreeDom",props:{x:{type:Number,default:0},y:{type:Number,default:0},width:{type:Number,default:0},height:{type:Number,default:0},absolute:{type:Boolean,default:void 0},scale:{type:[Boolean,Array],default:void 0},move:Boolean,preview:Boolean,limitWidth:{type:Number,default:void 0},limitHeight:{type:Number,default:void 0},handler:{type:String,default:void 0},diagonal:{type:Boolean,default:void 0}},emits:["update:x","update:y","update:width","update:height","select"],setup(e,{emit:t}){const n=_(!1),o=ne(C),a=D(()=>(o==null?void 0:o.preview)||e.preview),p=D(()=>!a.value&&((o==null?void 0:o.scale)||e.scale)),d=D(()=>!a.value&&((o==null?void 0:o.move)||e.move)),u=D(()=>e.absolute??(o==null?void 0:o.absolute)??!0),i=D(()=>e.handler??(o==null?void 0:o.handler)??"dot"),c=D(()=>e.diagonal??(o==null?void 0:o.diagonal)??!0),m=O(),w=_({}),h=Le(w),s=ke(),M=_(!1),R=_(!1),l=Q({x:0,y:0,width:0,height:0}),q=de(x),J={_rect:l,trigger:x};he(m,()=>{n.value=!1});function Y(r){return typeof r=="number"?r:parseFloat(r)}let U=!1;fe(()=>{l.width=e.width,l.height=e.height,l.x=e.x,l.y=e.y,U&&q(),U=!0}),pe(async()=>{o==null||o.register(s,J),await me();const r=m.value.getBoundingClientRect();l.width=l.width||r.width,l.height=l.height||r.height,l.x=l.x||0,l.y=l.y||0,x(),Z()});function x(){const{x:r,y:f,width:y,height:g}=l;w.value={transform:`translate(${r}px, ${f}px)`,width:y,height:g}}const F=D(()=>o&&Array.isArray(o.scale)?o.scale:e.scale),T=D(()=>ie.value?Array.isArray(F.value)?F.value:Fe:[]),V={l:"w",r:"e",t:"n",b:"s"},ie=O(!0);function ae(r,f){if(r.stopPropagation(),r.preventDefault(),R.value)return;M.value=!0,n.value=!0;const{clientX:y,clientY:g}=r;Pe(y,g,l,f,c.value,{onMove(){ee(l)&&(b.emit("move",s),x())},onUp(){M.value=!1,b.emit("moveup",s),Z()}})}function Z(){t("update:x",l.x),t("update:y",l.y),t("update:width",l.width),t("update:height",l.height)}function re(r){if(!w.value)return{};const{width:f,height:y}=w.value,g=/l/.test(r),B=/r/.test(r),N=/t/.test(r);let S,E;return r.length===2?(S=g?0:f,E=N?0:y):g||B?(S=g?0:f,E=Number(y)/2):(S=Number(f)/2,E=N?0:y),{top:i.value==="dot"?E:E-3+"px",left:i.value==="dot"?S:S-3+"px",cursor:r.split("").reverse().map(G=>V[G]).join("")+"-resize"}}function le(r){if(r.stopPropagation(),M.value||!d.value)return;R.value=!0,n.value=!0;const f=ue(w.value),y=B=>{const{clientX:N,clientY:S}=B,E=N-r.clientX+f.x,G=S-r.clientY+f.y;l.x=E,l.y=G,l.width=f.width,l.height=f.height,ee(l)&&(b.emit("move",s),x())},g=()=>{R.value=!1,b.emit("moveup",s),document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",g),Z(),t("select",l)};document.addEventListener("mousemove",y),document.addEventListener("mouseup",g)}function ee(r){if(o)return o.checkValid(r);if(e.limitWidth&&e.limitHeight){const{x:f,y,width:g,height:B}=r;return f>=0&&f+g<=e.limitWidth&&y>=0&&y+B<=e.limitHeight}else return!0}function ue(r){const{transform:f,width:y,height:g}=r,{x:B,y:N}=ce(f);return{x:B?Number(B):0,y:N?Number(N):0,width:parseFloat(y),height:parseFloat(g)}}function ce(r){if(!r)return{x:0,y:0};const f=/translate\(([.0-9]+)px[, ]+([.0-9]+)px\)/,[,y,g]=f.exec(r)??[];return{x:Y(y),y:Y(g)}}return{widgetRef:m,canMove:d,wrapStyle:h,canScale:p,dots:T,active:n,isAbsolute:u,isScale:M,handlerType:i,getDotPos:re,onMousedown:le,onMousedownDot:ae}},render(){const e=this.canScale?this.dots.map(n=>P("div",{class:this.handlerType==="dot"?"free-dom__widget-dot":"free-dom__resizable-handler",style:this.getDotPos(n),onMousedown:o=>this.onMousedownDot(o,n)})):null,t=typeof this.$slots.default=="function"?this.$slots.default():this.$slots.default;return P("section",{ref:"widgetRef",class:["free-dom__widget-wrapper",{"is-scale":this.isScale},{"is-absolute":this.isAbsolute},{"can-move":this.canMove},{"is-active":this.active}],style:this.wrapStyle,onMousedown:this.onMousedown},[t,e])}}),Ve=["xt","xc","xb","yl","yc","yr"],Xe=j({setup(){const e=ne(C),t=O(Ve),n=_(e.diff),o=e.nodes,a=Q({xt:{show:!1,pos:0},xc:{show:!1,pos:0},xb:{show:!1,pos:0},yl:{show:!1,pos:0},yc:{show:!1,pos:0},yr:{show:!1,pos:0}});b.on("move",async i=>{var m;const c=((m=o.find(w=>w.uuid===i))==null?void 0:m.node)??{};p(),o.forEach(w=>{if(w.uuid===i)return;const h=d(c._rect),s=d(w.node._rect);u(h.top,s.top)&&(a.xt={show:!0,pos:s.top},c._rect.y=s.top),u(h.bottom,s.top)&&(a.xt={show:!0,pos:s.top},c._rect.y=s.top-h.height),u(h.centerY,s.centerY)&&(a.xc={show:!0,pos:s.centerY},c._rect.y=s.centerY-h.height/2),u(h.top,s.bottom)&&(a.xb={show:!0,pos:s.bottom},c._rect.y=s.bottom),u(h.bottom,s.bottom)&&(a.xb={show:!0,pos:s.bottom},c._rect.y=s.bottom-h.height),u(h.left,s.left)&&(a.yl={show:!0,pos:s.left},c._rect.x=s.left),u(h.right,s.left)&&(a.yl={show:!0,pos:s.left},c._rect.x=s.left-h.width),u(h.centerX,s.centerX)&&(a.yc={show:!0,pos:s.centerX},c._rect.x=s.centerX-h.width/2),u(h.left,s.right)&&(a.yr={show:!0,pos:s.right},c._rect.x=s.right),u(h.right,s.right)&&(a.yr={show:!0,pos:s.right},c._rect.x=s.right-h.width)})}),b.on("moveup",p),ye(()=>{b.off("move"),b.off("moveup")});function p(){a.xt.show=!1,a.xc.show=!1,a.xb.show=!1,a.yl.show=!1,a.yc.show=!1,a.yr.show=!1}function d(i){return{top:i.y,bottom:i.y+i.height,left:i.x,right:i.x+i.width,width:i.width,height:i.height,centerX:i.x+i.width/2,centerY:i.y+i.height/2}}function u(i,c){return Math.abs(i-c)<=n.value}return{lines:t,diff:n,lineStatus:a}},render(){const e=(n,o)=>P("div",{style:{[n.includes("x")?"top":"left"]:o.pos+"px"},class:[n.includes("x")?"free-dom__xline":"free-dom__yline","free-dom__line"]}),t=this.lines.filter(n=>this.lineStatus[n].show).map(n=>e(n,this.lineStatus[n]));return P("div",{class:"free-dom__mark-line"},t)}}),Ye={absolute:{type:Boolean,default:void 0},preview:Boolean,move:Boolean,scale:[Boolean,Array],diff:{type:Number,default:3},handler:{type:String,default:void 0},diagonal:{type:Boolean,default:void 0}},ze=j({name:"FreeDomWrap",props:Ye,setup(e){const t=O(null),n=ve(t),o=_([]);function a(d,u){o.value.push({uuid:d,node:u})}function p(d){const{x:u,y:i,width:c,height:m}=d;return u>=0&&u+c<=n.width.value&&i>=0&&i+m<=n.height.value}return ge(C,Q({...we(e),nodes:o,register:a,checkValid:p})),{rectRef:t}},render(){const e=typeof this.$slots.default=="function"?this.$slots.default():this.$slots.default;return P("section",{ref:"rectRef"},[e,P(Xe)])}}),He=Te,Ie=ze;const We=j({__name:"Home",setup(e){const t=_(!1),n=_([{text:"测试文本",x:50,style:{color:"#d1239d"}},{text:"测试文本",style:{fontSize:"24px"}}]);function o(){t.value=!t.value}function a(){n.value.push({text:"测试文本",style:{}})}function p(d){console.log(d)}return(d,u)=>(X(),W(K,null,[z("button",{onClick:a}," 添加 "),z("button",{style:{"margin-left":"20px"},onClick:o},H(k(t)?"显示":"隐藏"),1),k(t)?Be("",!0):(X(),W(K,{key:0},[se(k(Ie),{move:"",scale:"",style:{width:"600px",height:"400px",border:"1px solid #999",position:"relative"}},{default:te(()=>[(X(!0),W(K,null,_e(k(n),(i,c)=>(X(),be(k(He),{key:c,x:i.x,"onUpdate:x":m=>i.x=m,y:i.y,"onUpdate:y":m=>i.y=m,width:i.width,"onUpdate:width":m=>i.width=m,height:i.height,"onUpdate:height":m=>i.height=m,scale:["rb"],style:Ue(i.style),handler:"mark",onSelect:p},{default:te(()=>[z("span",null,H(i.text)+H(c),1)]),_:2},1032,["x","onUpdate:x","y","onUpdate:y","width","onUpdate:width","height","onUpdate:height","style"]))),128))]),_:1}),z("pre",null,H(k(n)),1)],64))],64))}}),Je=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"index.md"}'),Oe={name:"index.md"};function je(e,t,n,o,a,p){const d=We;return X(),W("div",null,[se(d)])}const Ze=De(Oe,[["render",je]]);export{Je as __pageData,Ze as default};
